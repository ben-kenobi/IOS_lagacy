<!DOCTYPE html>
<!-- saved from url=(0049)http://www.cocoachina.com/ios/20150126/11011.html -->
<html><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><script async="" src="http://js.users.51.la/17642404.js?_=1435576236328"></script>
	<meta charset="UTF-8">
	
	<title>iOS 8自定义动画转场上手指南 -  CocoaChina 苹果开发中文站 - 最热的iPhone开发社区 最热的苹果开发社区 最热的iPad开发社区</title>
    <meta name="keywords" content="iOS 8,转场,segueiPhone开发,iOS开发,iPad开发,Mac开发,苹果开发中文站,iPhone开发中文站,CocoaChina首页, Mac OS开发, Cocoa介绍,移动互联网,触控科技,Cocoa,Apple,developer,iOS,iPhone,iPad,iMac,iPod Touch,iPhone5,iPhone4S,iPad3,招聘,iPhone程序员,Objective-c,iPhone应用外包,ios6,ios面试,Cocos2d-x,cocos2d,iTunes,App Store,苹果开发">
	<meta name="description" content=" - CocoaChina 开发讨论区 最热的iOS开发论坛| 最热的Mac开发论坛 | 最热的iPhone开发论坛 | 最热的iPad开发论坛">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
	<meta name="baidu-tc-cerfication" content="3300a939a1098c27e94457b75a0bb8c1">		
	<link rel="stylesheet" href="http://cdn.cocimg.com/cms/templets/style/global.css?20151" media="all">	
	<link rel="stylesheet" href="http://cdn.cocimg.com/cms/templets/style/index.css?2015" media="all">	
	<link href="http://cdn.cocimg.com/cms/templets/style/module.css?2015" rel="stylesheet">
	<link href="http://cdn.cocimg.com/cms/templets/style/style.css?20151" rel="stylesheet">
	<script type="text/javascript" async="" src="./iOS 8自定义动画转场上手指南 - CocoaChina 苹果开发中文站 - 最热的iPhone开发社区 最热的苹果开发社区 最热的iPad开发社区_files/ga.js"></script><script type="text/javascript" async="" src="./iOS 8自定义动画转场上手指南 - CocoaChina 苹果开发中文站 - 最热的iPhone开发社区 最热的苹果开发社区 最热的iPad开发社区_files/ga.js"></script><script src="http://hm.baidu.com/hm.js?88399e4c4cf744609c4fc8c3a8935691"></script><script src="./iOS 8自定义动画转场上手指南 - CocoaChina 苹果开发中文站 - 最热的iPhone开发社区 最热的苹果开发社区 最热的iPad开发社区_files/jquery-1.7.2.min.js" type="text/javascript"></script>
	<script type="text/javascript" src="http://js.adm.cnzz.net/js/abase.js"></script>
	
	<script>
		var _hmt = _hmt || [];
		(function() {
		  var hm = document.createElement("script");
		  hm.src = "//hm.baidu.com/hm.js?88399e4c4cf744609c4fc8c3a8935691";
		  var s = document.getElementsByTagName("script")[0]; 
		  s.parentNode.insertBefore(hm, s);
		})();
	</script>	
<script src="http://bdimg.share.baidu.com/static/api//js/share.js?v=89860593.js?cdnversion=398770"></script><script></script></head>
<body>
<!--top-->
<div class="top">
	<div id="topshow" class="t-wrap"><ul class="t-shortc"><li><a title="" target="_blank" href="http://open.cocoachina.com/">Cocos开发者平台</a></li><li><a title="" target="_blank" href="http://cn.cocos2d-x.org/">Cocos引擎中文官网</a></li><li><a title="" target="_blank" href="https://store.cocos.com/">Cocos商店</a></li></ul><div class="t-login"><a href="http://www.cocoachina.com/bbs/login.php?action=quit" class="float-r" style="margin-left:10px;margin-top:-7px">退出</a><a href="http://www.cocoachina.com/bbs/message.php" class="float-r img" title="点击查看消息" target="_blank"></a><a href="http://www.cocoachina.com/bbs/u.php?tid=477464" class="t-lid" target="_blank"><span class="t-lper"></span><span class="t-lname">完美世界_1230</span></a></div></div>
</div>	
<!--./top-->
<div class="header">
	<div class="h-wrap">
    	<div class="h-logo">
        	<a href="http://www.cocoachina.com/" title="" style="margin: 0 37px 0 10px;float:left;"><img src="./iOS 8自定义动画转场上手指南 - CocoaChina 苹果开发中文站 - 最热的iPhone开发社区 最热的苹果开发社区 最热的iPad开发社区_files/logo.png" height="53"></a>
            <div class="search">
            	<form action="http://www.cocoachina.com/cms/plus/search.php" id="searchform" name="formsearch" method="post" target="_blank">
					<input type="hidden" name="kwtype" value="0">
					<input type="hidden" name="searchtype" value="titlekeyword">				
					<input name="keyword" value="" type="text" id="search_keyword" placeholder="站内搜索">
                    <input type="button" class="ser-btn" value="" onclick="search_check()">
				</form>
                <div class="h-tags clearfix">
                	<a href="http://www.cocoachina.com/cms/plus/search.php?kwtype=0&keyword=iOS+8&searchtype=titlekeyword" title="" target="_blank">iOS 8</a>
                    <a href="http://www.cocoachina.com/cms/plus/search.php?kwtype=0&keyword=Swift&searchtype=titlekeyword" title="" target="_blank">Swift</a>
                    <a href="http://www.cocoachina.com/cms/plus/search.php?kwtype=0&keyword=App%20Store&searchtype=titlekeyword" title="" target="_blank">App Store</a>
                    <a href="http://www.cocoachina.com/cms/plus/search.php?kwtype=0&keyword=Apple%20Watch&searchtype=titlekeyword" title="" target="_blank">Apple Watch</a>
                    <a href="http://www.cocoachina.com/cms/plus/search.php?kwtype=0&keyword=Metal&searchtype=titlekeyword" title="" target="_blank">Metal</a>
                    <a href="http://www.cocoachina.com/cms/plus/search.php?kwtype=0&keyword=Cocos%E5%BC%95%E6%93%8E&searchtype=titlekeyword" title="" target="_blank">Cocos引擎</a>
                    <a href="http://www.cocoachina.com/cms/plus/search.php?kwtype=0&keyword=%E6%89%8B%E6%B8%B8&searchtype=titlekeyword" title="" target="_blank">手游</a>
                </div>
            </div>
            <div class="cc-ad1">
				<script>CNZZ_SLOT_RENDER('323844');</script>
            </div>
        </div>
        
        <div class="h-nav">        	          	
            <ul class="h-navl">
               	<li class="navl-1"><a id="ios" href="http://www.cocoachina.com/ios/" title="ios" class="light">iOS开发</a></li>
                <li class="navl-2"><a id="app_store" href="http://www.cocoachina.com/appstore/" title="appstore">App Store研究</a></li>
                <li class="navl-3"><a id="mac" href="http://www.cocoachina.com/mac/" title="mac">Mac开发</a></li>
                <li class="navl-4"><a id="design" href="http://www.cocoachina.com/design/" title="design">产品设计</a></li>
                <li class="navl-5"><a id="cocos" href="http://www.cocoachina.com/cocos/" title="cocos">Cocos引擎</a></li>
                <li class="navl-6"><a id="webapp" href="http://www.cocoachina.com/webapp/" title="webapp">WebApp</a></li>
                <li class="navl-1"><a id="swift" href="http://www.cocoachina.com/swift/" title="swift">Swift</a></li>
                <li class="navl-2"><a id="game" href="http://www.cocoachina.com/game/" title="game">游戏开发</a></li>
                <li class="navl-3"><a id="apple" href="http://www.cocoachina.com/apple/" title="apple">苹果相关</a></li>
                <li class="navl-4"><a id="market" href="http://www.cocoachina.com/market/" title="market">营销推广</a></li>
                <li class="navl-5"><a id="industry" href="http://www.cocoachina.com/industry/" title="industry">业界动态</a></li>
                <li class="navl-6"><a id="programmer" href="http://www.cocoachina.com/programmer/" title="programmer">程序人生</a></li>
            </ul> 
            <ul class="h-navr">
               	<li><a target="_blank" href="http://www.cocoachina.com/bbs/" title="bbs">论坛</a></li>
                <li><a target="_blank" href="http://code.cocoachina.com/" title="code">代码</a></li>
                <li><a target="_blank" href="http://www.cocoachina.com/special/index.html" title="special">专题</a></li>
                <li><a target="_blank" href="http://www.cocoachina.com/events/" title="events">活动</a></li>
                <li class="navr-last"><a target="_blank" href="http://job.cocoachina.com/" title="job">招聘</a></li>
            </ul>          
        </div>
    </div>
</div>


<script language="javascript">
    function IsPC() { 
		var userAgentInfo = navigator.userAgent; 
		var Agents = new Array("Android", "iPhone", "SymbianOS", "Windows Phone", "iPod"); 
		var flag = true; 
		for (var v = 0; v < Agents.length; v++) { 
		if (userAgentInfo.indexOf(Agents[v]) > 0) { flag = false; break; } 
		} 
		return flag; 
	}
    if (!IsPC()){
           window.location.href = "http://www.cocoachina.com/cms/wap.php?action=article&id=11011"; 
    }
	
</script>
<!--middle-->
<div class="middle clearfix">
	<div class="m-wrap">
		<!--left-->
		<div class="detail-left float-l">
			<p class="crumbs"><a href="http://www.cocoachina.com/" title="首页">首页</a> &gt;<a href="http://www.cocoachina.com/ios" title="iOS开发"><span id="type_name">iOS开发</span></a></p>  	       
			<div class="detail-main">
			<h2>iOS 8自定义动画转场上手指南</h2>
			<div class="p-ico clearfix">
				<div>
					<span class="ml0">2015-01-26 11:23</span>
					<span>编辑：
					<a href="http://www.cocoachina.com/bbs/u.php?action=feed&username=pockry" id="field_author" target="_blank">pockry</a></span>
					<span>分类：<a href="http://www.cocoachina.com/ios/" target="_blank">iOS开发</a></span>
					<span id="source">来源：ztdj121 投稿</span>

					<div class="float-r">
						<span><i></i> <script src="./iOS 8自定义动画转场上手指南 - CocoaChina 苹果开发中文站 - 最热的iPhone开发社区 最热的苹果开发社区 最热的iPad开发社区_files/count.php"></script>7</span>
						<span><i class="view"></i><script src="./iOS 8自定义动画转场上手指南 - CocoaChina 苹果开发中文站 - 最热的iPhone开发社区 最热的苹果开发社区 最热的iPad开发社区_files/count(1).php" language="javascript"></script>9645</span>
				</div>
				</div>
			</div>
			<div class="p-ico clearfix">
				<p class="related float-l"><a href="http://www.cocoachina.com/cms/tags.php?/iOS+8/" target="_blank">iOS 8</a><a href="http://www.cocoachina.com/cms/tags.php?/%E8%BD%AC%E5%9C%BA/" target="_blank">转场</a><a href="http://www.cocoachina.com/cms/tags.php?/segue/" target="_blank">segue</a></p>
				<input type="hidden" id="article_id" value="11011">
			</div>
			<div class="adsbox clearfix">
				<div class="float-l">
					<div class="float-l"><b>招聘信息：</b></div>
					<ul class="float-l" id="invitelist" style="margin-top: 0px;"><li><a href="http://job.cocoachina.com/job/show?id=65911" target="_blank">求iOS攻城狮一枚</a></li><li><a href="http://job.cocoachina.com/job/show?id=59618" target="_blank">iOS开发工程师</a></li><li><a href="http://job.cocoachina.com/job/show?id=65397" target="_blank">iOS开发工程师</a></li><li><a href="http://job.cocoachina.com/job/show?id=65696" target="_blank">杭州网易iOS开发工程师</a></li><li><a href="http://job.cocoachina.com/job/show?id=66230" target="_blank">iOS开发经理</a></li><li><a href="http://job.cocoachina.com/job/show?id=59428" target="_blank">iOS高级开发工程师(急招)</a></li><li><a href="http://job.cocoachina.com/job/show?id=65786" target="_blank">Cocos2d-X 前端主程</a></li><li><a href="http://job.cocoachina.com/job/show?id=61996" target="_blank">开发工程师</a></li><li><a href="http://job.cocoachina.com/job/show?id=65441" target="_blank">资深WEB前端开发工程师</a></li><li><a href="http://job.cocoachina.com/job/show?id=65375" target="_blank">iOS高级工程师</a></li><li><a href="http://job.cocoachina.com/job/show?id=65659" target="_blank">高级Java工程师</a></li></ul>
				</div>
				<div class="float-r">
					<a href="javascript:void(0)" class="prev"></a>
					<a href="javascript:void(0)" class="next"></a>
				</div>
			</div>
			<div id="detailbody" class="field_body">
				<p>（原文：<a href="http://www.appcoda.com/custom-segue-animations/" target="_blank">A Beginner’s Guide to Animated Custom Segues in iOS 8</a> 作者：gabriel theodoropoulos 译者：<a href="http://weibo.com/u/1896912903" target="_self">ztdj121</a>）</p><p>iOS 5发布的时候，苹果针对应用程序界面的设计，提出了一种全新的，革命性的方法—Storyboard，它从根本上改变了现有的设计理念。iOS 5之前，每个视图控制器通常都伴有一个Interface Builder的文件，叫nib或者xib，这个想法比较简单：每个视图控制器的界面应该在各自的nib文件中设计，而所有的nib文件一起构成了整个应用程序的界面。一方面，这个是很方便的，因为它强迫开发者在界面设计的时候将注意力集中在界面上，但另一方面，到最后，太多的文件不得不被创建，开发者将不能概览应用的整体界面。</p><p style="text-align:center"><img style="max-width:580px" src="./iOS 8自定义动画转场上手指南 - CocoaChina 苹果开发中文站 - 最热的iPhone开发社区 最热的苹果开发社区 最热的iPad开发社区_files/1421997798824215.jpg" title="1421997798824215.jpg" alt="custom-segue-featured-1024.jpg"></p><p>随着storyboard的产生，上面的这些都成为了历史，因为这种新方法受到了开发者社区的广泛使用。相比老的技术，storyboards提供了三个重要的优势：</p><ol class=" list-paddingleft-2" style="list-style-type: decimal;"><li><p>整个界面设计只发生在一个文件里。项目的总文件数量大大减少了，特别是在大项目里。当然你可以使用额外的nib文件，并且允许只创建辅助视图。</p></li><li><p>开发者能即时浏览应用的界面和流程。</p></li><li><p>视图控制器之间的转换（界面设计的专业术语叫场景（scene）），以及转换是如何发生的，在storyboard中已被完美地定义并清楚地呈现给了开发者。</p></li></ol><p>综上所述，场景之间的转换构成storyboard的特殊部分，我们一般把它叫做转场（segue）。</p><p>转场跟应用的导航和处理是密切相关的，因为它明确定义了一个视图切换到另一个视图的转换细节。这些细节指定了是否应用动画，动画的类型，当然还有实际转换时的准备和性能。除此之外，转场也用来将传递数据到下一个视图控制器里，这个用法也很常见。</p><p>从编程的角度看，场景是UIStoryboardSegue类的一个对象，它第一次在iOS 5中介绍到。和其它类的对象不同的是，这种对象不能直接的创建或使用。不过你可以指定转场的属性，然后在转场即将发生时提供给它以达到目的。UIKit框架提供了一些带默认动画过渡的预定义的转场，包括：push segues（包括导航控制器的app），带有动画选择的模态转场（modal segues）， popover segues。更高级的情况下，iOS SDK默认的转场可能不够用，所以开发者必须实现他们的自定义转场（custom segues）。</p><p>创建一个自定义转场并不难，因为它是iOS标准编程技术的组成部分。实际上你只需要生成UIStoryboardSegue的子类，并重载一个叫perform的方法即可。这个perform方法中必须实现自定义动画的逻辑。从一个视图控制器转换到另一个以及返回操作的触发，也需要由开发者编程提供，这是一个标准的步骤。</p><p>在本教程中，我的目标是向你们展示如何实现自定义转场，并通过一个简单的演示应用介绍这个概念的所有方面。拥有创建自定义转场的知识， 可以将你导向开发更强大的app的道路。此外，对于最大化用户体验，并开发引人注目的漂亮应用，自定义转场也很有帮助。</p><p>如果你有兴趣学习我刚刚说的话，就一起来探索教程里的所有细节和自定义转场的奥秘吧。</p><h2>应用程序概述</h2><p>不像我之前几个教程提供了一个启动项目，本教程我们将从头开始创建app。事实上，我是故意这么做的，因为，项目中一些重要部分需要用到Interface Builder，所以我认为从头开始按部就班的来做，能让你看清里面的细节。</p><p>正如我先前所说，我们将开发一个非常简单的app，在这个应用中我们将创建两个自定义转场。需要提前说明的是，我们的演示应用将有三个视图控制器，也就是在Interface Builder中有三个场景和三个相关类。默认情况下，第一个是由Xcode创建的，因此我们只要再添加两个。我们将创建的自定义转场用来导航第一个视图控制器到第二个（以及返回），以及从第一个到第三个（以及返回）。第二个和第三个视图控制器之间我们不添加任何联系。</p><p>因此，我们需要创建两个自定义转场。因为要包括返回，每一个转场需要创建两个对应的类（因此，共四个）：第一个类里我们将实现从第一个视图控制器到另一个转换的所有自定义逻辑。第二个类实现返回到第一个视图控制器的逻辑，或者换句话说要实现解除转场（unwind segue）。后面会讲到解除转场，现在只需要记住这就是用来让我们返回到前一个视图控制器的转场。</p><p>视图控制器本身没什么需要做的。我们会用一个label注明视图控制器的名称，每一个会有一个不同的背景颜色，可以让我们很容易地查看转换（是的，这将是一个五颜六色的应用）。第一个和第二个视图控制器也会多一个label，其中从其他视图控制器传来的自定义的消息将被显示出来。</p><p>最后，转场将在以下的动作发生的时候被触发：</p><ul class=" list-paddingleft-2" style="list-style-type: disc;"><li><p>从第一个视图控制器转换到第二个，我们将使用向上滑动的手势（swipe up）.而返回，使用向下滑动的手势（swipe down）。我不打算描述我们实现的动画，我会展示给你们看。</p></li><li><p>从第一个视图控制器转换到第三个，我们用一个按钮（UIButton）。而返回，使用向上滑动手势。对于动画不多做说明。</p></li></ul><p>当然，我们也会在视图控制器之间传递数据。</p><p>在我们继续之前，有个最终demo，将展示我们将要做的，以及我们的自定义转场是如何工作的。</p><p style="text-align:center"><img style="max-width:580px" src="./iOS 8自定义动画转场上手指南 - CocoaChina 苹果开发中文站 - 最热的iPhone开发社区 最热的苹果开发社区 最热的iPad开发社区_files/1421999721366749.gif" title="1421999721366749.gif" alt="final_sample.gif"></p><p>注意，创建一个自定义转场的时候，你可以实现任何一个你想到的或者需要的动画。我们做的时候，你可以尝试做下。</p><h2>创建应用程序</h2><p>我们开始启动Xcode，选择创建一个新工程。在出现的向导中，选择Single View Application作为工程的模板。选择下一步，在Product Name字段里，设置CustomSegues作为项目名称。同时，确保选择的编程语言是Swift，设备是iPhone。</p><p style="text-align:center"><img style="max-width:580px" src="./iOS 8自定义动画转场上手指南 - CocoaChina 苹果开发中文站 - 最热的iPhone开发社区 最热的苹果开发社区 最热的iPad开发社区_files/1421999778747821.png" title="1421999778747821.png" alt="t26_3_template2.png"></p><p>选择下一步。这步中，选择保存项目的路径，然后点击生成按钮。</p><p>现在工程已经准备好了，选择工程导航对应的组。默认情况下，General选项卡是打开的，这也是我们需要的。在Deployment Info部分，不选择Device Orientation区域里的Landscape Left 和 Landscape Right选项，只选择Portrait选项。如果你要在一个iOS 8之前的设备上测试，自由改变从8.1到之前的任意iOS版本deployment target。（最好不要运行在iOS 8之前的设备上）</p><p style="text-align:center"><img style="max-width:580px" src="./iOS 8自定义动画转场上手指南 - CocoaChina 苹果开发中文站 - 最热的iPhone开发社区 最热的苹果开发社区 最热的iPad开发社区_files/1421999927851975.png" title="1421999927851975.png" alt="t26_4_general_tab.png"></p><p>现在，我们准备好继续进行实现，通过第一个界面创建开始。</p><h2>初始界面设置</h2><p>第一步是添加我们在界面里要用到的视图控制器。所以，在工程导航栏（Project Navigator）里点击Main.storyboard文件，让Interface Builder显示出来。在三个不同的部分，我们将打破我们的工作，每一个里我们将设置一个视图控制器。但首先，要确保改变当前的尺寸类到Compact Width 和Regular Height，这样界面适配iPhone的尺寸。</p><p style="text-align:center"><img style="max-width:580px" src="./iOS 8自定义动画转场上手指南 - CocoaChina 苹果开发中文站 - 最热的iPhone开发社区 最热的苹果开发社区 最热的iPad开发社区_files/1421999968916680.png" title="1421999968916680.png" alt="t26_5_size_classes.png"></p><h2>配置第一个视图控制器</h2><p>当打开Interface Builder的时候，你会看到Xcode默认添加的场景。这就是我们开始的地方。在这个场景里添加两个UILabel对象。第一个设置属性如下：</p><ul class=" list-paddingleft-2" style="list-style-type: disc;"><li><p>Frame: X=16, Y=77, W=368, H=21</p></li><li><p>Font: System Bold</p></li><li><p>Font size: 24</p></li><li><p>Text: View Controller #1</p></li><li><p>Text alignment: Center</p></li></ul><p>同时，设置上下左右的约束条件：</p><p style="text-align:center"><img style="max-width:580px" src="./iOS 8自定义动画转场上手指南 - CocoaChina 苹果开发中文站 - 最热的iPhone开发社区 最热的苹果开发社区 最热的iPad开发社区_files/1422003527339812.png" title="1422003527339812.png" alt="t26_6_set_constraints1.png"></p><p>给第二个label，设置如下属性：</p><ul class=" list-paddingleft-2" style="list-style-type: disc;"><li><p>Frame: X=16, Y=390, W=368, H=21</p></li><li><p>Text: None</p></li><li><p>Text alignment: Center</p></li></ul><p>然后设它的Horizontal Center in Container, Vertical Center in Container），宽和高的约束条件。</p><p style="text-align:center"><img style="max-width:580px" src="./iOS 8自定义动画转场上手指南 - CocoaChina 苹果开发中文站 - 最热的iPhone开发社区 最热的苹果开发社区 最热的iPad开发社区_files/1422003558531484.png" title="1422003558531484.png" alt="t26_7_set_constraints2_1.png"><img style="line-height: 1.8;" src="./iOS 8自定义动画转场上手指南 - CocoaChina 苹果开发中文站 - 最热的iPhone开发社区 最热的苹果开发社区 最热的iPad开发社区_files/1422003568764895.png" title="1422003568764895.png" alt="t26_8_set_constraints2_2.png"></p><p>完成两个label的属性和约束条件设置之后，在场景中添加一个UIButton对象。参数设置如下：</p><ul class=" list-paddingleft-2" style="list-style-type: disc;"><li><p>Frame: X=169, Y=712, W=62, H=30</p></li><li><p>Title: Tap Me!</p></li><li><p>Text Color: Black</p></li></ul><p>关于它的约束条件，简单地点击Interface Builder右下角的大头针按钮，选择Selected Views部分里的Add Missing Contrains选项。</p><p>你完成之后，选择视图，改变背景颜色，打开Attributes Inspector里对应的下拉菜单，选择“Other…”选项。在颜色选择器里，点击调色板按钮然后选择蜡笔*调色板（因为比较柔和一点），关闭颜色选择器。</p><p style="text-align:center"><img style="max-width:580px" src="./iOS 8自定义动画转场上手指南 - CocoaChina 苹果开发中文站 - 最热的iPhone开发社区 最热的苹果开发社区 最热的iPad开发社区_files/1422003648627251.png" title="1422003648627251.png" alt="t26_9_color_picker.png"></p><p>下面是第一个场景的截图：</p><p style="text-align:center"><img style="max-width:580px" src="./iOS 8自定义动画转场上手指南 - CocoaChina 苹果开发中文站 - 最热的iPhone开发社区 最热的苹果开发社区 最热的iPad开发社区_files/1422003662508396.png" title="1422003662508396.png" alt="t26_10_ib_scene1.png"></p><h2>配置第二个视图控制器</h2><p>现在关注第二个视图控制器。在画布上直接从库里拖一个新的控制器对象。然后也添加两个UILabel对象，并设置和上面一样的属性。别忘了设置约束条件。这边唯一不同的地方是第一个label的文本，改为“View Controller #2!”（不带引号）。</p><p>下一步，选择视图，再次打开颜色选择器，这次选择Honeydew（列表中第二个），然后关闭颜色选择器。</p><p>这时，Xcode将给你个警告，因为两个视图控制器之间没有转场（segue）。没关系，我们马上就要解决这个问题了。</p><p>下面这个图展示了第二个场景：</p><p style="text-align:center"><img style="max-width:580px" src="./iOS 8自定义动画转场上手指南 - CocoaChina 苹果开发中文站 - 最热的iPhone开发社区 最热的苹果开发社区 最热的iPad开发社区_files/1422003718944290.png" title="1422003718944290.png" alt="t26_11_ib_scene2.png"></p><h2>配置第三个视图控制器</h2><p>最后，我们从对象库里再添加一个视图控制器到画布上。这次，只添加一个UILabel对象，不是两个。设置和前两个场景中第一个label一样的属性。有两个不同点：第一，设置label的framde的Y值为389；第二，设置文本为“View Controller #3!”。这个视图里没有其他子视图了，你只要选择一个背景颜色。和之前两次一样，在颜色选择器里选择sky颜色。</p><p>对于它的约束条件，和之前两个视图控制器里的第二个label一样设置 Horizontal Center in Container, Vertical Center in Container,以及宽和高。设置Y值和约束条件，让label正好显示在视图中间。</p><p>界面中第三个场景看起来是这样的：</p><p style="text-align:center"><img style="max-width:580px" src="./iOS 8自定义动画转场上手指南 - CocoaChina 苹果开发中文站 - 最热的iPhone开发社区 最热的苹果开发社区 最热的iPad开发社区_files/1422003901470160.png" title="1422003901470160.png" alt="t26_12_ib_scene3.png"></p><h2>添加新的视图控制器类</h2><p>我们之前添加到界面上的每一个场景，必须设置一个不同的类来实现每一个细节。默认情况下，ViewController设定为每个场景的类，这非常适合我们的第一个视图控制器（这个是Xcode自动创建的）。而其他两个，我们需要创建两个新类，下面就让我们来实现一下。</p><p>第一步是创建新的类文件，到Xcode菜单里File&gt;New&gt;File…，启动这个过程，引导创建新文件的细节出现了，所以第一步要确保选择iOS下，Source类别里的Cocoa Touch Class。</p><p>点击下一步按钮。在向导的第二步，在Subclass of里：字段选择或输入UIViewController的值。然后指定SecondViewController作为你刚刚创建的名字。当然你不能改变编程语言，确保最后字段里选择的是Swift语言。</p><p>点击下一步，生成新的文件。一旦完成，你会看到一个叫SecondViewController.swift的新文件，出现在Project导航器里。</p><p>重复上述过程，给第三个视图控制器添加类文件。类名设置为ThirdViewController，剩下的步骤都一样。</p><p>添加完第二个文件后，你应该能在Project导航器里看到这两个文件：</p><p style="text-align:center"><img style="max-width:580px" src="./iOS 8自定义动画转场上手指南 - CocoaChina 苹果开发中文站 - 最热的iPhone开发社区 最热的苹果开发社区 最热的iPad开发社区_files/1422004269467978.png" title="1422004269467978.png" alt="t26_15_project_navigator_new_classes.png"></p><p>我们回到Interface Builder和新创建场景的类之前，让我们先声明两个后面要用到的IBOutlet的属性，在ViewController.swift里添加如下属性：</p><div><div id="highlighter_443458" class="syntaxhighlighter  js"><table border="0" cellpadding="0" cellspacing="0"><tbody><tr><td class="gutter"><div class="line number1 index0 alt2">1</div></td><td class="code"><div class="container"><div class="line number1 index0 alt2"><code class="js plain">@IBOutlet&nbsp;weak&nbsp;</code><code class="js keyword">var</code>&nbsp;<code class="js plain">lblMessage:&nbsp;UILabel!</code></div></div></td></tr></tbody></table></div></div><p>在SecondViewController.swift文件里，添加和上面完全一样的设置。这两个属性被连接到开始的两个试图控制器里的第二个label上，稍后我们可以显示一条消息给它们。</p><p>现在再次打开Main.storyboard文件，选择第二个场景（绿色背景那个）。这个上面点击视图控制器对象，进到工具面板里的Identity inspector里，在Custom Class部分，具体在Class字段，设置我们在工程开始时候添加的第一个类：SecondViewController:</p><p style="text-align:center"><img style="max-width:580px" src="./iOS 8自定义动画转场上手指南 - CocoaChina 苹果开发中文站 - 最热的iPhone开发社区 最热的苹果开发社区 最热的iPad开发社区_files/1422007342196699.png" title="1422007342196699.png" alt="t26_16_second_scene_class.png"></p><p>第三个场景（蓝色背景的）也一样的处理。选择后，点击视图控制器的上面，设置ThirdViewController作为它的类：</p><p style="text-align:center"><img style="max-width:580px" src="./iOS 8自定义动画转场上手指南 - CocoaChina 苹果开发中文站 - 最热的iPhone开发社区 最热的苹果开发社区 最热的iPad开发社区_files/1422007361696236.png" title="1422007361696236.png" alt="t26_17_third_scene_class.png"></p><p>好了，现在每个场景匹配了一个不同的类。在这部分的最后，我们连接两个之前声明的IBOutlet属性，从第一个视图控制器（橙色背景的那个）开始。点击视图控制器对象的上面，按住Ctrl拖向场景中的那个label：</p><p style="text-align:center"><img style="max-width:580px" src="./iOS 8自定义动画转场上手指南 - CocoaChina 苹果开发中文站 - 最热的iPhone开发社区 最热的苹果开发社区 最热的iPad开发社区_files/1422007377946888.png" title="1422007377946888.png" alt="t26_18_connect_iboutlet.png"></p><p>在弹出的小窗口里，选择lblMessage属性，这样联系就完成了。</p><p style="text-align:center"><img style="max-width:580px" src="./iOS 8自定义动画转场上手指南 - CocoaChina 苹果开发中文站 - 最热的iPhone开发社区 最热的苹果开发社区 最热的iPad开发社区_files/1422007392806749.png" title="1422007392806749.png" alt="t26_19_select_iboutlet.png"></p><p>在SecondViewController场景里一样的步骤，关联那个视图控制器的lblMessage属性到场景中的label上。</p><h2>添加自定义转场类</h2><p>自定义转场的创建包括UIStoryboardSegue的子类化，以及一个必须实现的perform方法。方法中，视图控制器转换的自定义逻辑实际是在这里应用，所以，在写转场相关的代码之前，让我们先添加所有必要的类。</p><p>工程中添加新类的方法之前已经详细介绍过了，所以你需要添加文件的时候也可以将它当成指南。在我给你们每个文件的细节之前，我们一共要创建4个文件。因为每个自定义转场需要两个类，我们将创建两个文件。具体地说，第一个类用来实现所有的逻辑，以及转场执行的转换动画。第二个类用来实现从第二个视图控制器到第一个的相反动作。也就是所谓的解除转场（unwind segue），我们稍后将详细介绍。</p><p>综上所述，开始向项目中添加新类。添加每个文件时注意两个问题：总是选择Cocoa Touch Class模板，以及向导中第二步的字段，设置Subclass of的值为UIStoryboardSegue。</p><p>我们将四个文件的名字命名为：</p><ul class=" list-paddingleft-2" style="list-style-type: disc;"><li><p>FirstCustomSegue</p></li><li><p>FirstCustomSegueUnwind</p></li><li><p>SecondCustomSegue</p></li><li><p>SecondCustomSegueUnwind</p></li></ul><p>这四个文件加完后都显示在Project导航器里了。</p><h2>创建第一个自定义转场</h2><p>现在让我们开始第一个自定义转场。写代码之前，必须在Interface Builder里添加转场，给我们想应用自定义转换的地方联系两个场景。本例中，我们将创建的转场是从ViewController场景（橙色背景）到SecondViewController场景（绿色背景）。</p><p>再次打开Main.storyboard，简单地创建新转场(Segue)，扩大文档大纲，如果它被隐藏的话，选择ViewController场景里的ViewController对象：</p><p style="text-align:center"><img style="max-width:580px" src="./iOS 8自定义动画转场上手指南 - CocoaChina 苹果开发中文站 - 最热的iPhone开发社区 最热的苹果开发社区 最热的iPad开发社区_files/1422007783694618.png" title="1422007783694618.png" alt="t26_21_document_outline.png"></p><p>然后，按住Ctrl将SecondViewController拖向下面的SecondViewController场景中：</p><p style="text-align:center"><img style="max-width:580px" src="./iOS 8自定义动画转场上手指南 - CocoaChina 苹果开发中文站 - 最热的iPhone开发社区 最热的苹果开发社区 最热的iPad开发社区_files/1422007794667209.png" title="1422007794667209.png" alt="t26_22_create_segue_connect.png"></p><p>关于新的转场，弹出个有很多选项的黑色弹出框。其中有个叫custom：</p><p style="text-align:center"><img style="max-width:580px" src="./iOS 8自定义动画转场上手指南 - CocoaChina 苹果开发中文站 - 最热的iPhone开发社区 最热的苹果开发社区 最热的iPad开发社区_files/1422007818193007.png" title="1422007818193007.png" alt="t26_23_create_segue_select_custom.png"></p><p>点击它，转场就立马建立了。你可以通过检查画布中是否添加了一根连接两个场景的连线进行验证。</p><p style="text-align:center"><img style="max-width:580px" src="./iOS 8自定义动画转场上手指南 - CocoaChina 苹果开发中文站 - 最热的iPhone开发社区 最热的苹果开发社区 最热的iPad开发社区_files/1422007840766251.png" title="1422007840766251.png" alt="t26_24_segue_line.png"></p><p>我们开始写代码之前还有些设置要完成。首先，点击选择画布上的转场，打开Utilities面板里的属性检查器（Attributes inspector）。我们要做得最重要的一个任务是，设置转场的identifier值，在代码中会用到这个以便我们引用。真正重要的是不要给多个转场指定相同的标示符。所以，本例中，设置idFirstSegue为转场的标示符。同时在Segue Class字段里，必须指定我们用来执行自定义转换的自定义类。这里，我们设置FirstCustomSegue为自定义转场的类。运行的时候，程序会执行这个类里存在的代码，让转场正常执行。</p><p style="text-align:center"><img style="max-width:580px" src="./iOS 8自定义动画转场上手指南 - CocoaChina 苹果开发中文站 - 最热的iPhone开发社区 最热的苹果开发社区 最热的iPad开发社区_files/1422237296379989.png" title="1422237296379989.png" alt="t26_25_set_segue_identifier.png"></p><h2>自定义转场的实现</h2><p>现在新的自定义转场有了，它的设置也指定好了，接下来让我们实现第一个视图控制器到第二个控制器的理想的转换。简而言之，写关于自定义转场的代码通常要做的是，“玩”两个视图控制器的视图。首先，目标视图控制器的视图的初始状态是被指定的，并且被手动添加到应用的窗口上。然后使用动画目标视图被放到想要放的最终位置，源视图控制离开屏幕的时候也是动画的。</p><p>注意：转场对象是指将被当做目标视图控制器呈现的视图控制器，而当前的视图控制器就是源视图控制器（source view controller）。</p><p>最后，当动画转换结束的时候，新的视图控制器将直接呈现给用户，没有更多的动画。</p><p>app概述部分的教程中，你已经看到了我们想要达到的效果。不管转场怎么执行，我们希望第一个视图控制器的视图是向上滑动，第二个视图控制器的视图跟着动。两个视图之间没有空隙，第二个把第一个给“粘住”了。</p><p>现在让我们开始写代码，我们一步一步的看。最后，我会一起提供以下方法的所有实现。</p><p>打开FirstCustomSegue.swift文件，添加以下方法定义：</p><div><div id="highlighter_478483" class="syntaxhighlighter  js"><table border="0" cellpadding="0" cellspacing="0"><tbody><tr><td class="gutter"><div class="line number1 index0 alt2">1</div><div class="line number2 index1 alt1">2</div><div class="line number3 index2 alt2">3</div></td><td class="code"><div class="container"><div class="line number1 index0 alt2"><code class="js plain">override&nbsp;func&nbsp;perform()&nbsp;{</code></div><div class="line number2 index1 alt1">&nbsp;</div><div class="line number3 index2 alt2"><code class="js plain">}</code></div></div></td></tr></tbody></table></div></div><p>这个方法已经在UIStoryboardSegue的父类里定义了，这里我们重载这个方法，以便我们添加想要的自定义逻辑。所以，第一步是使我们的工作更简单，它指定视图的源和目标视图控制器的两个局部变量，如下所示：</p><div><div id="highlighter_933380" class="syntaxhighlighter  js"><table border="0" cellpadding="0" cellspacing="0"><tbody><tr><td class="gutter"><div class="line number1 index0 alt2">1</div><div class="line number2 index1 alt1">2</div><div class="line number3 index2 alt2">3</div><div class="line number4 index3 alt1">4</div><div class="line number5 index4 alt2">5</div><div class="line number6 index5 alt1">6</div></td><td class="code"><div class="container"><div class="line number1 index0 alt2"><code class="js plain">override&nbsp;func&nbsp;perform()&nbsp;{</code></div><div class="line number2 index1 alt1"><code class="js spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="js comments">//&nbsp;Assign&nbsp;the&nbsp;source&nbsp;and&nbsp;destination&nbsp;views&nbsp;to&nbsp;local&nbsp;variables.</code></div><div class="line number3 index2 alt2"><code class="js spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="js keyword">var</code>&nbsp;<code class="js plain">firstVCView&nbsp;=&nbsp;self.sourceViewController.view&nbsp;as&nbsp;UIView!</code></div><div class="line number4 index3 alt1"><code class="js spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="js keyword">var</code>&nbsp;<code class="js plain">secondVCView&nbsp;=&nbsp;self.destinationViewController.view&nbsp;as&nbsp;UIView!</code></div><div class="line number5 index4 alt2">&nbsp;</div><div class="line number6 index5 alt1"><code class="js plain">}</code></div></div></td></tr></tbody></table></div></div><p>另外，我们需要屏幕的宽和高，然后放在两个变量里：</p><div><div id="highlighter_700202" class="syntaxhighlighter  js"><table border="0" cellpadding="0" cellspacing="0"><tbody><tr><td class="gutter"><div class="line number1 index0 alt2">1</div><div class="line number2 index1 alt1">2</div><div class="line number3 index2 alt2">3</div><div class="line number4 index3 alt1">4</div><div class="line number5 index4 alt2">5</div><div class="line number6 index5 alt1">6</div><div class="line number7 index6 alt2">7</div><div class="line number8 index7 alt1">8</div></td><td class="code"><div class="container"><div class="line number1 index0 alt2"><code class="js plain">override&nbsp;func&nbsp;perform()&nbsp;{</code></div><div class="line number2 index1 alt1"><code class="js spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="js plain">...</code></div><div class="line number3 index2 alt2">&nbsp;</div><div class="line number4 index3 alt1"><code class="js spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="js comments">//&nbsp;Get&nbsp;the&nbsp;screen&nbsp;width&nbsp;and&nbsp;height.</code></div><div class="line number5 index4 alt2"><code class="js spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="js plain">let&nbsp;screenWidth&nbsp;=&nbsp;UIScreen.mainScreen().bounds.size.width</code></div><div class="line number6 index5 alt1"><code class="js spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="js plain">let&nbsp;screenHeight&nbsp;=&nbsp;UIScreen.mainScreen().bounds.size.height</code></div><div class="line number7 index6 alt2">&nbsp;</div><div class="line number8 index7 alt1"><code class="js plain">}</code></div></div></td></tr></tbody></table></div></div><p>好了，现在指定应该出现的视图的初始位置。考虑到我们想要视图从底部移动到上面，我们把视图放在屏幕可视区域的外面，当前视图的正下方。这很简单，我们简单地设置下视图的frame：</p><div><div id="highlighter_778269" class="syntaxhighlighter  js"><table border="0" cellpadding="0" cellspacing="0"><tbody><tr><td class="gutter"><div class="line number1 index0 alt2">1</div><div class="line number2 index1 alt1">2</div><div class="line number3 index2 alt2">3</div><div class="line number4 index3 alt1">4</div><div class="line number5 index4 alt2">5</div><div class="line number6 index5 alt1">6</div><div class="line number7 index6 alt2">7</div></td><td class="code"><div class="container"><div class="line number1 index0 alt2"><code class="js plain">override&nbsp;func&nbsp;perform()&nbsp;{</code></div><div class="line number2 index1 alt1"><code class="js spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="js plain">...</code></div><div class="line number3 index2 alt2">&nbsp;</div><div class="line number4 index3 alt1"><code class="js spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="js comments">//&nbsp;Specify&nbsp;the&nbsp;initial&nbsp;position&nbsp;of&nbsp;the&nbsp;destination&nbsp;view.</code></div><div class="line number5 index4 alt2"><code class="js spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="js plain">secondVCView.frame&nbsp;=&nbsp;CGRectMake(0.0,&nbsp;screenHeight,&nbsp;screenWidth,&nbsp;screenHeight)</code></div><div class="line number6 index5 alt1">&nbsp;</div><div class="line number7 index6 alt2"><code class="js plain">}</code></div></div></td></tr></tbody></table></div></div><p>这时，第二个视图控制器的视图还不是窗口的子视图。所以，在我们实现真正的动画之前，很明显，我们必须把它加到窗口上。这用窗口对象的方法insertSubview(view:aboveSubview:)来实现。正如你接下来看到的，我们先访问窗口对象，然后添加目标视图：</p><div><div id="highlighter_207406" class="syntaxhighlighter  js"><table border="0" cellpadding="0" cellspacing="0"><tbody><tr><td class="gutter"><div class="line number1 index0 alt2">1</div><div class="line number2 index1 alt1">2</div><div class="line number3 index2 alt2">3</div><div class="line number4 index3 alt1">4</div><div class="line number5 index4 alt2">5</div><div class="line number6 index5 alt1">6</div><div class="line number7 index6 alt2">7</div><div class="line number8 index7 alt1">8</div></td><td class="code"><div class="container"><div class="line number1 index0 alt2"><code class="js plain">override&nbsp;func&nbsp;perform()&nbsp;{</code></div><div class="line number2 index1 alt1"><code class="js spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="js plain">...</code></div><div class="line number3 index2 alt2">&nbsp;</div><div class="line number4 index3 alt1"><code class="js spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="js comments">//&nbsp;Access&nbsp;the&nbsp;app's&nbsp;key&nbsp;window&nbsp;and&nbsp;insert&nbsp;the&nbsp;destination&nbsp;view&nbsp;above&nbsp;the&nbsp;current&nbsp;(source)&nbsp;one.</code></div><div class="line number5 index4 alt2"><code class="js spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="js plain">let&nbsp;window&nbsp;=&nbsp;UIApplication.sharedApplication().keyWindow</code></div><div class="line number6 index5 alt1"><code class="js spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="js plain">window?.insertSubview(secondVCView,&nbsp;aboveSubview:&nbsp;firstVCView)</code></div><div class="line number7 index6 alt2">&nbsp;</div><div class="line number8 index7 alt1"><code class="js plain">}</code></div></div></td></tr></tbody></table></div></div><p>别被上面的话给搞糊涂了。关于窗口子视图，他们的顺序看起来像在栈里一样。一般而言它不会带来麻烦。</p><p>最后，让我们给转换过程添加动画。首先，我们将第一个视图控制器的视图从屏幕上方移出边缘，同时，把第二个视图放到第一个的位置上。实际上，所谓的“移动”，就是修改两个视图的frame：</p><div><div id="highlighter_590339" class="syntaxhighlighter  js"><table border="0" cellpadding="0" cellspacing="0"><tbody><tr><td class="gutter"><div class="line number1 index0 alt2">1</div><div class="line number2 index1 alt1">2</div><div class="line number3 index2 alt2">3</div><div class="line number4 index3 alt1">4</div><div class="line number5 index4 alt2">5</div><div class="line number6 index5 alt1">6</div><div class="line number7 index6 alt2">7</div><div class="line number8 index7 alt1">8</div><div class="line number9 index8 alt2">9</div><div class="line number10 index9 alt1">10</div><div class="line number11 index10 alt2">11</div><div class="line number12 index11 alt1">12</div><div class="line number13 index12 alt2">13</div></td><td class="code"><div class="container"><div class="line number1 index0 alt2"><code class="js plain">override&nbsp;func&nbsp;perform()&nbsp;{</code></div><div class="line number2 index1 alt1"><code class="js spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="js plain">...</code></div><div class="line number3 index2 alt2">&nbsp;</div><div class="line number4 index3 alt1"><code class="js spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="js comments">//&nbsp;Animate&nbsp;the&nbsp;transition.</code></div><div class="line number5 index4 alt2"><code class="js spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="js plain">UIView.animateWithDuration(0.4,&nbsp;animations:&nbsp;{&nbsp;()&nbsp;-&gt;&nbsp;Void&nbsp;</code><code class="js keyword">in</code>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</div><div class="line number6 index5 alt1"><code class="js spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="js plain">firstVCView.frame&nbsp;=&nbsp;CGRectOffset(firstVCView.frame,&nbsp;0.0,&nbsp;-screenHeight)</code></div><div class="line number7 index6 alt2"><code class="js spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="js plain">secondVCView.frame&nbsp;=&nbsp;CGRectOffset(secondVCView.frame,&nbsp;0.0,&nbsp;-screenHeight)</code></div><div class="line number8 index7 alt1">&nbsp;</div><div class="line number9 index8 alt2"><code class="js spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="js plain">})&nbsp;{&nbsp;(Finished)&nbsp;-&gt;&nbsp;Void&nbsp;</code><code class="js keyword">in</code></div><div class="line number10 index9 alt1">&nbsp;</div><div class="line number11 index10 alt2"><code class="js spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="js plain">}</code></div><div class="line number12 index11 alt1">&nbsp;</div><div class="line number13 index12 alt2"><code class="js plain">}</code></div></div></td></tr></tbody></table></div></div><p>上面两行代码将执行预期的效果。然而，我们还没完全结束，因为我们还没显示出新的视图控制器（目标视图控制器）。我们将在第二个闭包里实现：</p><div><div id="highlighter_743584" class="syntaxhighlighter  js"><table border="0" cellpadding="0" cellspacing="0"><tbody><tr><td class="gutter"><div class="line number1 index0 alt2">1</div><div class="line number2 index1 alt1">2</div><div class="line number3 index2 alt2">3</div><div class="line number4 index3 alt1">4</div><div class="line number5 index4 alt2">5</div><div class="line number6 index5 alt1">6</div><div class="line number7 index6 alt2">7</div><div class="line number8 index7 alt1">8</div><div class="line number9 index8 alt2">9</div><div class="line number10 index9 alt1">10</div><div class="line number11 index10 alt2">11</div><div class="line number12 index11 alt1">12</div><div class="line number13 index12 alt2">13</div><div class="line number14 index13 alt1">14</div><div class="line number15 index14 alt2">15</div></td><td class="code"><div class="container"><div class="line number1 index0 alt2"><code class="js plain">override&nbsp;func&nbsp;perform()&nbsp;{</code></div><div class="line number2 index1 alt1"><code class="js spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="js plain">...</code></div><div class="line number3 index2 alt2">&nbsp;</div><div class="line number4 index3 alt1"><code class="js spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="js comments">//&nbsp;Animate&nbsp;the&nbsp;transition.</code></div><div class="line number5 index4 alt2"><code class="js spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="js plain">UIView.animateWithDuration(0.4,&nbsp;animations:&nbsp;{&nbsp;()&nbsp;-&gt;&nbsp;Void&nbsp;</code><code class="js keyword">in</code></div><div class="line number6 index5 alt1"><code class="js spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="js plain">firstVCView.frame&nbsp;=&nbsp;CGRectOffset(firstVCView.frame,&nbsp;0.0,&nbsp;-screenHeight)</code></div><div class="line number7 index6 alt2"><code class="js spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="js plain">secondVCView.frame&nbsp;=&nbsp;CGRectOffset(secondVCView.frame,&nbsp;0.0,&nbsp;-screenHeight)</code></div><div class="line number8 index7 alt1">&nbsp;</div><div class="line number9 index8 alt2"><code class="js spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="js plain">})&nbsp;{&nbsp;(Finished)&nbsp;-&gt;&nbsp;Void&nbsp;</code><code class="js keyword">in</code></div><div class="line number10 index9 alt1"><code class="js spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="js plain">self.sourceViewController.presentViewController(self.destinationViewController&nbsp;as&nbsp;UIViewController,</code></div><div class="line number11 index10 alt2"><code class="js spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="js plain">animated:&nbsp;</code><code class="js keyword">false</code><code class="js plain">,</code></div><div class="line number12 index11 alt1"><code class="js spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="js plain">completion:&nbsp;nil)</code></div><div class="line number13 index12 alt2"><code class="js spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="js plain">}</code></div><div class="line number14 index13 alt1">&nbsp;</div><div class="line number15 index14 alt2"><code class="js plain">}</code></div></div></td></tr></tbody></table></div></div><p>动画部分到这里就结束了。总结一下：</p><div><div id="highlighter_838591" class="syntaxhighlighter  js"><table border="0" cellpadding="0" cellspacing="0"><tbody><tr><td class="gutter"><div class="line number1 index0 alt2">1</div><div class="line number2 index1 alt1">2</div><div class="line number3 index2 alt2">3</div><div class="line number4 index3 alt1">4</div><div class="line number5 index4 alt2">5</div><div class="line number6 index5 alt1">6</div><div class="line number7 index6 alt2">7</div><div class="line number8 index7 alt1">8</div><div class="line number9 index8 alt2">9</div><div class="line number10 index9 alt1">10</div><div class="line number11 index10 alt2">11</div><div class="line number12 index11 alt1">12</div><div class="line number13 index12 alt2">13</div><div class="line number14 index13 alt1">14</div><div class="line number15 index14 alt2">15</div><div class="line number16 index15 alt1">16</div><div class="line number17 index16 alt2">17</div><div class="line number18 index17 alt1">18</div><div class="line number19 index18 alt2">19</div><div class="line number20 index19 alt1">20</div><div class="line number21 index20 alt2">21</div><div class="line number22 index21 alt1">22</div><div class="line number23 index22 alt2">23</div><div class="line number24 index23 alt1">24</div><div class="line number25 index24 alt2">25</div><div class="line number26 index25 alt1">26</div><div class="line number27 index26 alt2">27</div><div class="line number28 index27 alt1">28</div></td><td class="code"><div class="container"><div class="line number1 index0 alt2"><code class="js plain">override&nbsp;func&nbsp;perform()&nbsp;{</code></div><div class="line number2 index1 alt1"><code class="js spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="js comments">//&nbsp;Assign&nbsp;the&nbsp;source&nbsp;and&nbsp;destination&nbsp;views&nbsp;to&nbsp;local&nbsp;variables.</code></div><div class="line number3 index2 alt2"><code class="js spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="js keyword">var</code>&nbsp;<code class="js plain">firstVCView&nbsp;=&nbsp;self.sourceViewController.view&nbsp;as&nbsp;UIView!</code></div><div class="line number4 index3 alt1"><code class="js spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="js keyword">var</code>&nbsp;<code class="js plain">secondVCView&nbsp;=&nbsp;self.destinationViewController.view&nbsp;as&nbsp;UIView!</code></div><div class="line number5 index4 alt2">&nbsp;</div><div class="line number6 index5 alt1"><code class="js spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="js comments">//&nbsp;Get&nbsp;the&nbsp;screen&nbsp;width&nbsp;and&nbsp;height.</code></div><div class="line number7 index6 alt2"><code class="js spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="js plain">let&nbsp;screenWidth&nbsp;=&nbsp;UIScreen.mainScreen().bounds.size.width</code></div><div class="line number8 index7 alt1"><code class="js spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="js plain">let&nbsp;screenHeight&nbsp;=&nbsp;UIScreen.mainScreen().bounds.size.height</code></div><div class="line number9 index8 alt2">&nbsp;</div><div class="line number10 index9 alt1"><code class="js spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="js comments">//&nbsp;Specify&nbsp;the&nbsp;initial&nbsp;position&nbsp;of&nbsp;the&nbsp;destination&nbsp;view.</code></div><div class="line number11 index10 alt2"><code class="js spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="js plain">secondVCView.frame&nbsp;=&nbsp;CGRectMake(0.0,&nbsp;screenHeight,&nbsp;screenWidth,&nbsp;screenHeight)</code></div><div class="line number12 index11 alt1">&nbsp;</div><div class="line number13 index12 alt2"><code class="js spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="js comments">//&nbsp;Access&nbsp;the&nbsp;app's&nbsp;key&nbsp;window&nbsp;and&nbsp;insert&nbsp;the&nbsp;destination&nbsp;view&nbsp;above&nbsp;the&nbsp;current&nbsp;(source)&nbsp;one.</code></div><div class="line number14 index13 alt1"><code class="js spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="js plain">let&nbsp;window&nbsp;=&nbsp;UIApplication.sharedApplication().keyWindow</code></div><div class="line number15 index14 alt2"><code class="js spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="js plain">window?.insertSubview(secondVCView,&nbsp;aboveSubview:&nbsp;firstVCView)</code></div><div class="line number16 index15 alt1">&nbsp;</div><div class="line number17 index16 alt2"><code class="js spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="js comments">//&nbsp;Animate&nbsp;the&nbsp;transition.</code></div><div class="line number18 index17 alt1"><code class="js spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="js plain">UIView.animateWithDuration(0.4,&nbsp;animations:&nbsp;{&nbsp;()&nbsp;-&gt;&nbsp;Void&nbsp;</code><code class="js keyword">in</code></div><div class="line number19 index18 alt2"><code class="js spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="js plain">firstVCView.frame&nbsp;=&nbsp;CGRectOffset(firstVCView.frame,&nbsp;0.0,&nbsp;-screenHeight)</code></div><div class="line number20 index19 alt1"><code class="js spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="js plain">secondVCView.frame&nbsp;=&nbsp;CGRectOffset(secondVCView.frame,&nbsp;0.0,&nbsp;-screenHeight)</code></div><div class="line number21 index20 alt2">&nbsp;</div><div class="line number22 index21 alt1"><code class="js spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="js plain">})&nbsp;{&nbsp;(Finished)&nbsp;-&gt;&nbsp;Void&nbsp;</code><code class="js keyword">in</code></div><div class="line number23 index22 alt2"><code class="js spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="js plain">self.sourceViewController.presentViewController(self.destinationViewController&nbsp;as&nbsp;UIViewController,</code></div><div class="line number24 index23 alt1"><code class="js spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="js plain">animated:&nbsp;</code><code class="js keyword">false</code><code class="js plain">,</code></div><div class="line number25 index24 alt2"><code class="js spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="js plain">completion:&nbsp;nil)</code></div><div class="line number26 index25 alt1"><code class="js spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="js plain">}</code></div><div class="line number27 index26 alt2">&nbsp;</div><div class="line number28 index27 alt1"><code class="js plain">}</code></div></div></td></tr></tbody></table></div></div><p>在你给app第一次调试之前，我们还必须执行自定义转场。这个发生在ViewController视图控制器的视图上做向上滑动的手势。所以，继续打开ViewController.swift文件。在viewDidLoad方法里创建一个新的手势对象，然后把它加到视图里：</p><div><div id="highlighter_752760" class="syntaxhighlighter  js"><table border="0" cellpadding="0" cellspacing="0"><tbody><tr><td class="gutter"><div class="line number1 index0 alt2">1</div><div class="line number2 index1 alt1">2</div><div class="line number3 index2 alt2">3</div><div class="line number4 index3 alt1">4</div><div class="line number5 index4 alt2">5</div><div class="line number6 index5 alt1">6</div><div class="line number7 index6 alt2">7</div></td><td class="code"><div class="container"><div class="line number1 index0 alt2"><code class="js plain">override&nbsp;func&nbsp;viewDidLoad()&nbsp;{</code></div><div class="line number2 index1 alt1"><code class="js spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="js plain">...</code></div><div class="line number3 index2 alt2">&nbsp;</div><div class="line number4 index3 alt1"><code class="js spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="js keyword">var</code>&nbsp;<code class="js plain">swipeGestureRecognizer:&nbsp;UISwipeGestureRecognizer&nbsp;=&nbsp;UISwipeGestureRecognizer(target:&nbsp;self,&nbsp;action:&nbsp;</code><code class="js string">"showSecondViewController"</code><code class="js plain">)</code></div><div class="line number5 index4 alt2"><code class="js spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="js plain">swipeGestureRecognizer.direction&nbsp;=&nbsp;UISwipeGestureRecognizerDirection.Up</code></div><div class="line number6 index5 alt1"><code class="js spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="js plain">self.view.addGestureRecognizer(swipeGestureRecognizer)</code></div><div class="line number7 index6 alt2"><code class="js plain">}</code></div></div></td></tr></tbody></table></div></div><p>当手势被执行的时候，showSecondViewController方法应该是被调用的，但还没实现。因此，让我们添加它的定义，这里我们将添加简单的一行代码来执行自定义转场：</p><div><div id="highlighter_251587" class="syntaxhighlighter  js"><table border="0" cellpadding="0" cellspacing="0"><tbody><tr><td class="gutter"><div class="line number1 index0 alt2">1</div><div class="line number2 index1 alt1">2</div><div class="line number3 index2 alt2">3</div></td><td class="code"><div class="container"><div class="line number1 index0 alt2"><code class="js plain">func&nbsp;showSecondViewController()&nbsp;{</code></div><div class="line number2 index1 alt1"><code class="js spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="js plain">self.performSegueWithIdentifier(</code><code class="js string">"idFirstSegue"</code><code class="js plain">,&nbsp;sender:&nbsp;self)</code></div><div class="line number3 index2 alt2"><code class="js plain">}</code></div></div></td></tr></tbody></table></div></div><p>可以注意到，我们是通过标示符来访问转场的。当我们滑动到视图，以上的调用使我们在FirstCustomSegue类里的自定义实现得以执行。</p><p>你现在可以调试app了。你可以在模拟器上运行，也可以在真机上运行。不过，即使你可以向上滑动来转换视图，你不能返回到第一个视图控制器。这是正常的，因为我们还没有定义，我们接下来将实现这个方法。</p><h2>解除转场（The Unwind Segue）</h2><p>创建自定义转场的时候，需要同时实现导航里的两个方法：从源视图控制器到目标视图控制器，然后返回。几乎不可能只建立一个方法。现在我们已经实现了转场，所以它将按我们想要的动画方式显示第二个视图控制器，我们必须让app能够做相反的事情。执行返回导航的转场，叫解除转场（unwind segue）。</p><p>简而言之，解除转场和正常的一样，但是它的配置有点复杂。某些步骤还是要完成的，但没有超出标准编程技术之外的东西。注意两点：</p><ol class=" list-paddingleft-2" style="list-style-type: decimal;"><li><p>解除转场（unwind segue）通常和正常自定义转场（segue）一起出现。</p></li><li><p>要解除转场起作用，我们必须重写perform方法，并应用自定义逻辑和我们想要的或者应用规定的动画。另外，导航返回源视图控制器的过渡效果不需要和对应的正常转场相同。</p></li></ol><p>解除转场的实现分四个步骤：</p><ol class=" list-paddingleft-2" style="list-style-type: decimal;"><li><p>IBAction方法的创建，该方法在解除转场被执行的时候会选择地执行一些代码。这个方法可以有你想要的任何名字，而且不强制包含其它东西。它需要定义，但可以留空，解除转场的定义需要依赖这个方法。</p></li><li><p>解除转场的创建，设置的配置。这和之前我们在Interface Builder里的转场不太一样，等下我们将看看这个是怎么实现的。</p></li><li><p>通过重写UIStoryboardSegue子类里的perform方法，来实现一般的逻辑。</p></li><li><p>UIViewController类提供了特定方法的定义，所以系统知道解除转场即将执行。</p></li></ol><p>现在你可以会有些迷糊，接下来，我们会解释所有的东西。</p><p>先从上面提到的第一个步骤里的IBAction方法开始。这个方法通常在我们想要导航的初始视图控制器里实现。如我所说，方法里可以是空的，但是你得记住如果你不定义至少一个这样的方法，你将无法继续。当解除转场存在在app中，没必要使用那么多的方法。通常情况下，简单地定义一个这样的动作方法，检测对应的解除转场对应然后调用，就足够了。</p><p>现在行动，打开ViewController.swift文件，添加如下代码：</p><div><div id="highlighter_44051" class="syntaxhighlighter  js"><table border="0" cellpadding="0" cellspacing="0"><tbody><tr><td class="gutter"><div class="line number1 index0 alt2">1</div><div class="line number2 index1 alt1">2</div><div class="line number3 index2 alt2">3</div></td><td class="code"><div class="container"><div class="line number1 index0 alt2"><code class="js plain">@IBAction&nbsp;func&nbsp;returnFromSegueActions(sender:&nbsp;UIStoryboardSegue){</code></div><div class="line number2 index1 alt1">&nbsp;</div><div class="line number3 index2 alt2"><code class="js plain">}</code></div></div></td></tr></tbody></table></div></div><p>我们将稍后添加些示例代码。注意这个方法的参数是一个UIStoryboardSegue对象，这个是需要记住的细节。</p><p>现在让我们去Interface Builder里，打开Main.storyboard文件。是时候创建解除转场了。我们开始检查SecondViewController场景里包含的对象，甚至查看场景本身，或者文档大纲。如果你仔细观察，你会发现一个对象，叫Exit：</p><p style="text-align: center;"><img style="max-width:580px" src="./iOS 8自定义动画转场上手指南 - CocoaChina 苹果开发中文站 - 最热的iPhone开发社区 最热的苹果开发社区 最热的iPad开发社区_files/1422239090485391.png" title="1422239090485391.png" alt="t26_26_exit_1.png"><br><img style="max-width:580px" src="./iOS 8自定义动画转场上手指南 - CocoaChina 苹果开发中文站 - 最热的iPhone开发社区 最热的苹果开发社区 最热的iPad开发社区_files/1422239099588196.png" title="1422239099588196.png" alt="t26_27_exit_2.png"></p><p>如果你还没创建过自定义转场，很可能你不会用到它，可能会想知道这个干什么的。这个就是你需要创建的解除转场。</p><p>点击场景里SecondViewController对象，按Ctrl拖到Exit对象：</p><p style="text-align:center"><img style="max-width:580px" src="./iOS 8自定义动画转场上手指南 - CocoaChina 苹果开发中文站 - 最热的iPhone开发社区 最热的苹果开发社区 最热的iPad开发社区_files/1422239144513955.png" title="1422239144513955.png" alt="t26_28_unwind_exit.png"></p><p>下面的弹出框会显示我们早前定义的IBAction方法：</p><p style="text-align:center"><img style="max-width:580px" src="./iOS 8自定义动画转场上手指南 - CocoaChina 苹果开发中文站 - 最热的iPhone开发社区 最热的苹果开发社区 最热的iPad开发社区_files/1422239155381604.png" title="1422239155381604.png" alt="t26_29_unwind_popup.png"></p><p>确保选中它。解除转场将被创建，你可以在文档大纲里查看到。现在新的联线被创建了，但转场在这里：</p><p style="text-align:center"><img style="max-width:580px" src="./iOS 8自定义动画转场上手指南 - CocoaChina 苹果开发中文站 - 最热的iPhone开发社区 最热的苹果开发社区 最热的iPad开发社区_files/1422239180673104.png" title="1422239180673104.png" alt="t26_30_unwind_segue_listed.png"></p><p>现在点击我们刚创建的解除转场，打开属性检查器。设置“idFirstSegueUnwind”作为转场的标示符：</p><p style="text-align:center"><img style="max-width:580px" src="./iOS 8自定义动画转场上手指南 - CocoaChina 苹果开发中文站 - 最热的iPhone开发社区 最热的苹果开发社区 最热的iPad开发社区_files/1422239212252695.png" title="1422239212252695.png" alt="t26_31_set_unwind_segue_identifier.png"></p><p>解除转场的第二部分目前已经完成了。接下来我们要开始写代码了，并确定解除转场的执行方法。</p><p>首先，打开FirstCustomSegueUnWind.swift文件，再次重写perform方法，并保持对视图的局部变量的引用。同时，我们也要在一个变量中保存屏幕高度：</p><div><div id="highlighter_53907" class="syntaxhighlighter  js"><table border="0" cellpadding="0" cellspacing="0"><tbody><tr><td class="gutter"><div class="line number1 index0 alt2">1</div><div class="line number2 index1 alt1">2</div><div class="line number3 index2 alt2">3</div><div class="line number4 index3 alt1">4</div><div class="line number5 index4 alt2">5</div><div class="line number6 index5 alt1">6</div><div class="line number7 index6 alt2">7</div></td><td class="code"><div class="container"><div class="line number1 index0 alt2"><code class="js plain">override&nbsp;func&nbsp;perform()&nbsp;{</code></div><div class="line number2 index1 alt1"><code class="js spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="js comments">//&nbsp;Assign&nbsp;the&nbsp;source&nbsp;and&nbsp;destination&nbsp;views&nbsp;to&nbsp;local&nbsp;variables.</code></div><div class="line number3 index2 alt2"><code class="js spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="js keyword">var</code>&nbsp;<code class="js plain">secondVCView&nbsp;=&nbsp;self.sourceViewController.view&nbsp;as&nbsp;UIView!</code></div><div class="line number4 index3 alt1"><code class="js spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="js keyword">var</code>&nbsp;<code class="js plain">firstVCView&nbsp;=&nbsp;self.destinationViewController.view&nbsp;as&nbsp;UIView!</code></div><div class="line number5 index4 alt2">&nbsp;</div><div class="line number6 index5 alt1"><code class="js spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="js plain">let&nbsp;screenHeight&nbsp;=&nbsp;UIScreen.mainScreen().bounds.size.height</code></div><div class="line number7 index6 alt2"><code class="js plain">}</code></div></div></td></tr></tbody></table></div></div><p>注意，现在源视图控制器是SecondViewController，目标视图控制器是ViewController。继续，这里我们不指定任何视图的初始状态，我们只把第一个视图控制的视图（我们想要返回的那个）加到窗口的子视图上：</p><div><div id="highlighter_721722" class="syntaxhighlighter  js"><table border="0" cellpadding="0" cellspacing="0"><tbody><tr><td class="gutter"><div class="line number1 index0 alt2">1</div><div class="line number2 index1 alt1">2</div><div class="line number3 index2 alt2">3</div><div class="line number4 index3 alt1">4</div><div class="line number5 index4 alt2">5</div><div class="line number6 index5 alt1">6</div><div class="line number7 index6 alt2">7</div></td><td class="code"><div class="container"><div class="line number1 index0 alt2"><code class="js plain">override&nbsp;func&nbsp;perform()&nbsp;{</code></div><div class="line number2 index1 alt1"><code class="js spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="js plain">...</code></div><div class="line number3 index2 alt2">&nbsp;</div><div class="line number4 index3 alt1"><code class="js spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="js plain">let&nbsp;window&nbsp;=&nbsp;UIApplication.sharedApplication().keyWindow</code></div><div class="line number5 index4 alt2"><code class="js spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="js plain">window?.insertSubview(firstVCView,&nbsp;aboveSubview:&nbsp;secondVCView)</code></div><div class="line number6 index5 alt1">&nbsp;</div><div class="line number7 index6 alt2"><code class="js plain">}</code></div></div></td></tr></tbody></table></div></div><p>最后，我们必须激活两个视图的运动。这次，他们都往底部移动：</p><div><div id="highlighter_449817" class="syntaxhighlighter  js"><table border="0" cellpadding="0" cellspacing="0"><tbody><tr><td class="gutter"><div class="line number1 index0 alt2">1</div><div class="line number2 index1 alt1">2</div><div class="line number3 index2 alt2">3</div><div class="line number4 index3 alt1">4</div><div class="line number5 index4 alt2">5</div><div class="line number6 index5 alt1">6</div><div class="line number7 index6 alt2">7</div><div class="line number8 index7 alt1">8</div><div class="line number9 index8 alt2">9</div><div class="line number10 index9 alt1">10</div><div class="line number11 index10 alt2">11</div><div class="line number12 index11 alt1">12</div><div class="line number13 index12 alt2">13</div><div class="line number14 index13 alt1">14</div><div class="line number15 index14 alt2">15</div></td><td class="code"><div class="container"><div class="line number1 index0 alt2"><code class="js plain">override&nbsp;func&nbsp;perform()&nbsp;{</code></div><div class="line number2 index1 alt1"><code class="js spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="js plain">...</code></div><div class="line number3 index2 alt2">&nbsp;</div><div class="line number4 index3 alt1"><code class="js spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="js comments">//&nbsp;Animate&nbsp;the&nbsp;transition.</code></div><div class="line number5 index4 alt2"><code class="js spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="js plain">UIView.animateWithDuration(0.4,&nbsp;animations:&nbsp;{&nbsp;()&nbsp;-&gt;&nbsp;Void&nbsp;</code><code class="js keyword">in</code>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</div><div class="line number6 index5 alt1"><code class="js spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="js plain">firstVCView.frame&nbsp;=&nbsp;CGRectOffset(firstVCView.frame,&nbsp;0.0,&nbsp;screenHeight)</code></div><div class="line number7 index6 alt2"><code class="js spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="js plain">secondVCView.frame&nbsp;=&nbsp;CGRectOffset(secondVCView.frame,&nbsp;0.0,&nbsp;screenHeight)</code></div><div class="line number8 index7 alt1">&nbsp;</div><div class="line number9 index8 alt2"><code class="js spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="js plain">})&nbsp;{&nbsp;(Finished)&nbsp;-&gt;&nbsp;Void&nbsp;</code><code class="js keyword">in</code></div><div class="line number10 index9 alt1">&nbsp;</div><div class="line number11 index10 alt2"><code class="js spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="js plain">self.sourceViewController.dismissViewControllerAnimated(</code><code class="js keyword">false</code><code class="js plain">,&nbsp;completion:&nbsp;nil)</code></div><div class="line number12 index11 alt1"><code class="js spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="js plain">}</code></div><div class="line number13 index12 alt2">&nbsp;</div><div class="line number14 index13 alt1">&nbsp;</div><div class="line number15 index14 alt2"><code class="js plain">}</code></div></div></td></tr></tbody></table></div></div><p>通过改变两个视图的y值，我们设法把他们在预定义动画的时间内放到新的位置上。当转换结束，我们只要让第二个视图控制器直接消失，不带任何动画，然后就结束了。下面一起给你这个方法的实现：</p><div><div id="highlighter_342133" class="syntaxhighlighter  js"><table border="0" cellpadding="0" cellspacing="0"><tbody><tr><td class="gutter"><div class="line number1 index0 alt2">1</div><div class="line number2 index1 alt1">2</div><div class="line number3 index2 alt2">3</div><div class="line number4 index3 alt1">4</div><div class="line number5 index4 alt2">5</div><div class="line number6 index5 alt1">6</div><div class="line number7 index6 alt2">7</div><div class="line number8 index7 alt1">8</div><div class="line number9 index8 alt2">9</div><div class="line number10 index9 alt1">10</div><div class="line number11 index10 alt2">11</div><div class="line number12 index11 alt1">12</div><div class="line number13 index12 alt2">13</div><div class="line number14 index13 alt1">14</div><div class="line number15 index14 alt2">15</div><div class="line number16 index15 alt1">16</div><div class="line number17 index16 alt2">17</div><div class="line number18 index17 alt1">18</div><div class="line number19 index18 alt2">19</div><div class="line number20 index19 alt1">20</div></td><td class="code"><div class="container"><div class="line number1 index0 alt2"><code class="js plain">override&nbsp;func&nbsp;perform()&nbsp;{</code></div><div class="line number2 index1 alt1"><code class="js spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="js comments">//&nbsp;Assign&nbsp;the&nbsp;source&nbsp;and&nbsp;destination&nbsp;views&nbsp;to&nbsp;local&nbsp;variables.</code></div><div class="line number3 index2 alt2"><code class="js spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="js keyword">var</code>&nbsp;<code class="js plain">secondVCView&nbsp;=&nbsp;self.sourceViewController.view&nbsp;as&nbsp;UIView!</code></div><div class="line number4 index3 alt1"><code class="js spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="js keyword">var</code>&nbsp;<code class="js plain">firstVCView&nbsp;=&nbsp;self.destinationViewController.view&nbsp;as&nbsp;UIView!</code></div><div class="line number5 index4 alt2">&nbsp;</div><div class="line number6 index5 alt1"><code class="js spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="js plain">let&nbsp;screenHeight&nbsp;=&nbsp;UIScreen.mainScreen().bounds.size.height</code></div><div class="line number7 index6 alt2">&nbsp;</div><div class="line number8 index7 alt1"><code class="js spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="js plain">let&nbsp;window&nbsp;=&nbsp;UIApplication.sharedApplication().keyWindow</code></div><div class="line number9 index8 alt2"><code class="js spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="js plain">window?.insertSubview(firstVCView,&nbsp;aboveSubview:&nbsp;secondVCView)</code></div><div class="line number10 index9 alt1">&nbsp;</div><div class="line number11 index10 alt2"><code class="js spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="js comments">//&nbsp;Animate&nbsp;the&nbsp;transition.</code></div><div class="line number12 index11 alt1"><code class="js spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="js plain">UIView.animateWithDuration(0.4,&nbsp;animations:&nbsp;{&nbsp;()&nbsp;-&gt;&nbsp;Void&nbsp;</code><code class="js keyword">in</code></div><div class="line number13 index12 alt2"><code class="js spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="js plain">firstVCView.frame&nbsp;=&nbsp;CGRectOffset(firstVCView.frame,&nbsp;0.0,&nbsp;screenHeight)</code></div><div class="line number14 index13 alt1"><code class="js spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="js plain">secondVCView.frame&nbsp;=&nbsp;CGRectOffset(secondVCView.frame,&nbsp;0.0,&nbsp;screenHeight)</code></div><div class="line number15 index14 alt2">&nbsp;</div><div class="line number16 index15 alt1"><code class="js spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="js plain">})&nbsp;{&nbsp;(Finished)&nbsp;-&gt;&nbsp;Void&nbsp;</code><code class="js keyword">in</code></div><div class="line number17 index16 alt2">&nbsp;</div><div class="line number18 index17 alt1"><code class="js spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="js plain">self.sourceViewController.dismissViewControllerAnimated(</code><code class="js keyword">false</code><code class="js plain">,&nbsp;completion:&nbsp;nil)</code></div><div class="line number19 index18 alt2"><code class="js spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="js plain">}</code></div><div class="line number20 index19 alt1"><code class="js plain">}</code></div></div></td></tr></tbody></table></div></div><p>目前为止还好，我们成功创建了初始化要求的IBAction方法和解除转场，实现了动画转换执行的自定义逻辑。现在，还剩最后一个标准方法需要实现，那个方法里，我们会使用FirstCustomSegueUnwind类。</p><p>打开ViewController.swift文件，定义一下方法：</p><div><div id="highlighter_773965" class="syntaxhighlighter  js"><table border="0" cellpadding="0" cellspacing="0"><tbody><tr><td class="gutter"><div class="line number1 index0 alt2">1</div><div class="line number2 index1 alt1">2</div><div class="line number3 index2 alt2">3</div></td><td class="code"><div class="container"><div class="line number1 index0 alt2"><code class="js plain">override&nbsp;func&nbsp;segueForUnwindingToViewController(toViewController:&nbsp;UIViewController,&nbsp;fromViewController:&nbsp;UIViewController,&nbsp;identifier:&nbsp;String?)&nbsp;-&gt;&nbsp;UIStoryboardSegue&nbsp;{</code></div><div class="line number2 index1 alt1">&nbsp;</div><div class="line number3 index2 alt2"><code class="js plain">}</code></div></div></td></tr></tbody></table></div></div><p>这是UIViewController类提供的方法。在解除转场执行的时候会自动调用这个方法，其实现是手动添加的。有三个参数：</p><ol class=" list-paddingleft-2" style="list-style-type: decimal;"><li><p>fromViewController: 当前显示的视图控制器，是我们想让它消失的。</p></li><li><p>toViewController: 目标视图控制器，或者换句话说是我们想显示的控制器。</p></li><li><p>identifier: 将被执行的转场的标示符。</p></li></ol><p>注意，这个方法返回的是一个转场对象。我们要做的很简单：我们会用identifier的值来决定要执行的那个转场，然后初始化一个解除转场自定义类的对象，这个类对象是我们最后要返回的。同时，调用一个super的方法，在这里重载下，让我们看看代码：</p><div><div id="highlighter_526185" class="syntaxhighlighter  js"><table border="0" cellpadding="0" cellspacing="0"><tbody><tr><td class="gutter"><div class="line number1 index0 alt2">1</div><div class="line number2 index1 alt1">2</div><div class="line number3 index2 alt2">3</div><div class="line number4 index3 alt1">4</div><div class="line number5 index4 alt2">5</div><div class="line number6 index5 alt1">6</div><div class="line number7 index6 alt2">7</div><div class="line number8 index7 alt1">8</div><div class="line number9 index8 alt2">9</div><div class="line number10 index9 alt1">10</div><div class="line number11 index10 alt2">11</div><div class="line number12 index11 alt1">12</div></td><td class="code"><div class="container"><div class="line number1 index0 alt2"><code class="js plain">override&nbsp;func&nbsp;segueForUnwindingToViewController(toViewController:&nbsp;UIViewController,&nbsp;fromViewController:&nbsp;UIViewController,&nbsp;identifier:&nbsp;String?)&nbsp;-&gt;&nbsp;UIStoryboardSegue&nbsp;{</code></div><div class="line number2 index1 alt1"><code class="js spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="js keyword">if</code>&nbsp;<code class="js plain">let&nbsp;id&nbsp;=&nbsp;identifier{</code></div><div class="line number3 index2 alt2"><code class="js spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="js keyword">if</code>&nbsp;<code class="js plain">id&nbsp;==&nbsp;</code><code class="js string">"idFirstSegueUnwind"</code>&nbsp;<code class="js plain">{</code></div><div class="line number4 index3 alt1"><code class="js spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="js plain">let&nbsp;unwindSegue&nbsp;=&nbsp;FirstCustomSegueUnwind(identifier:&nbsp;id,&nbsp;source:&nbsp;fromViewController,&nbsp;destination:&nbsp;toViewController,&nbsp;performHandler:&nbsp;{&nbsp;()&nbsp;-&gt;&nbsp;Void&nbsp;</code><code class="js keyword">in</code></div><div class="line number5 index4 alt2">&nbsp;</div><div class="line number6 index5 alt1"><code class="js spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="js plain">})</code></div><div class="line number7 index6 alt2"><code class="js spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="js keyword">return</code>&nbsp;<code class="js plain">unwindSegue</code></div><div class="line number8 index7 alt1"><code class="js spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="js plain">}&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code></div><div class="line number9 index8 alt2"><code class="js spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="js plain">}</code></div><div class="line number10 index9 alt1">&nbsp;</div><div class="line number11 index10 alt2"><code class="js spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="js keyword">return</code>&nbsp;<code class="js keyword">super</code><code class="js plain">.segueForUnwindingToViewController(toViewController,&nbsp;fromViewController:&nbsp;fromViewController,&nbsp;identifier:&nbsp;identifier)</code></div><div class="line number12 index11 alt1"><code class="js plain">}</code></div></div></td></tr></tbody></table></div></div><p>首先，我们要确认identifier参数有实际的值，所以用if let语句。然后用idFirstSegueUnwind值来确认这个转场是我们想要的，在if语句中初始化FirstCustomSegueUnwind类对象。这个对象在if语句中返回，外面我们返回调用super类之后同一个方法返回的值。</p><p>现在解除转场准备好了。剩下实现的是触发的它的手势。打开SecondViewController.swift文件，直接到viewDidLoad方法里。添加如下代码：</p><div><div id="highlighter_311923" class="syntaxhighlighter  js"><table border="0" cellpadding="0" cellspacing="0"><tbody><tr><td class="gutter"><div class="line number1 index0 alt2">1</div><div class="line number2 index1 alt1">2</div><div class="line number3 index2 alt2">3</div><div class="line number4 index3 alt1">4</div><div class="line number5 index4 alt2">5</div><div class="line number6 index5 alt1">6</div><div class="line number7 index6 alt2">7</div><div class="line number8 index7 alt1">8</div></td><td class="code"><div class="container"><div class="line number1 index0 alt2"><code class="js plain">override&nbsp;func&nbsp;viewDidLoad()&nbsp;{</code></div><div class="line number2 index1 alt1"><code class="js spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="js plain">...</code></div><div class="line number3 index2 alt2">&nbsp;</div><div class="line number4 index3 alt1"><code class="js spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="js keyword">var</code>&nbsp;<code class="js plain">swipeGestureRecognizer:&nbsp;UISwipeGestureRecognizer&nbsp;=&nbsp;UISwipeGestureRecognizer(target:&nbsp;self,&nbsp;action:&nbsp;</code><code class="js string">"showFirstViewController"</code><code class="js plain">)</code></div><div class="line number5 index4 alt2"><code class="js spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="js plain">swipeGestureRecognizer.direction&nbsp;=&nbsp;UISwipeGestureRecognizerDirection.Down</code></div><div class="line number6 index5 alt1"><code class="js spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="js plain">self.view.addGestureRecognizer(swipeGestureRecognizer)</code></div><div class="line number7 index6 alt2">&nbsp;</div><div class="line number8 index7 alt1"><code class="js plain">}</code></div></div></td></tr></tbody></table></div></div><p>上面定义的手势是向下滑动的手势，刚好与之前的相反。</p><p>现在定义showFirstViewController方法：</p><div><div id="highlighter_65358" class="syntaxhighlighter  js"><table border="0" cellpadding="0" cellspacing="0"><tbody><tr><td class="gutter"><div class="line number1 index0 alt2">1</div><div class="line number2 index1 alt1">2</div><div class="line number3 index2 alt2">3</div></td><td class="code"><div class="container"><div class="line number1 index0 alt2"><code class="js plain">func&nbsp;showFirstViewController()&nbsp;{</code></div><div class="line number2 index1 alt1"><code class="js spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="js plain">self.performSegueWithIdentifier(</code><code class="js string">"idFirstSegueUnwind"</code><code class="js plain">,&nbsp;sender:&nbsp;self)</code></div><div class="line number3 index2 alt2"><code class="js plain">}</code></div></div></td></tr></tbody></table></div></div><p>现在一切都准备好了，你可以再次调试app。这次，你可以在视图控制器之间来回导航。</p><h2>执行操作</h2><p>前面的部分，我们声明了一个空方法：returnFromSegueActions(sender:), 我们说这个方法是必须的，这样我们才能创建解除转场。同时，我也说过后面会添加一些代码，现在我们就要添加代码了。</p><p>在这个操作方法中，我们准备做一个很简单的任务：改变第一个视图控制器的背景颜色，然后用UIView的动画把它恢复到正常状态。虽然这个操作在真正的app里面毫无意义，但这是个好的例子，可以让我们看到解除转场运行的时候是怎么操作的。</p><p>到ViewController.swift文件，在IBAction方法里，添加如下内容：</p><div><div id="highlighter_407504" class="syntaxhighlighter  js"><table border="0" cellpadding="0" cellspacing="0"><tbody><tr><td class="gutter"><div class="line number1 index0 alt2">1</div><div class="line number2 index1 alt1">2</div><div class="line number3 index2 alt2">3</div><div class="line number4 index3 alt1">4</div><div class="line number5 index4 alt2">5</div><div class="line number6 index5 alt1">6</div><div class="line number7 index6 alt2">7</div><div class="line number8 index7 alt1">8</div><div class="line number9 index8 alt2">9</div><div class="line number10 index9 alt1">10</div></td><td class="code"><div class="container"><div class="line number1 index0 alt2"><code class="js plain">@IBAction&nbsp;func&nbsp;returnFromSegueActions(sender:&nbsp;UIStoryboardSegue){</code></div><div class="line number2 index1 alt1"><code class="js spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="js keyword">if</code>&nbsp;<code class="js plain">sender.identifier&nbsp;==&nbsp;</code><code class="js string">"idFirstSegueUnwind"</code>&nbsp;<code class="js plain">{</code></div><div class="line number3 index2 alt2"><code class="js spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="js plain">let&nbsp;originalColor&nbsp;=&nbsp;self.view.backgroundColor</code></div><div class="line number4 index3 alt1"><code class="js spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="js plain">self.view.backgroundColor&nbsp;=&nbsp;UIColor.redColor()</code></div><div class="line number5 index4 alt2">&nbsp;</div><div class="line number6 index5 alt1"><code class="js spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="js plain">UIView.animateWithDuration(1.0,&nbsp;animations:&nbsp;{&nbsp;()&nbsp;-&gt;&nbsp;Void&nbsp;</code><code class="js keyword">in</code></div><div class="line number7 index6 alt2"><code class="js spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="js plain">self.view.backgroundColor&nbsp;=&nbsp;originalColor</code></div><div class="line number8 index7 alt1"><code class="js spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="js plain">})</code></div><div class="line number9 index8 alt2"><code class="js spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="js plain">}</code></div><div class="line number10 index9 alt1"><code class="js plain">}</code></div></div></td></tr></tbody></table></div></div><p>首先检查这个解除转场是不是我们感兴趣的那个，然后把背景颜色保存在本地，改成红色，然后使用动画部分的块，设回到原来的值。</p><p>以上清楚地展示了当一个自定义解除转场被执行的时候你想执行动作的时候你应该怎么操作。稍后我们继续在上面的方法里添加一些代码。</p><h2>传递数据</h2><p>在实现自定义转场（和解除转场）的时候，要注意两点：一，注意你设置的转换效果，以使你的app提供良好的的用户体验。二，执行一般的转场或者解除转场的时候，视图控制器之间的数据交换。</p><p>前面部分我们已经涉及到了第一种情况，我们指定了两个视图来回切换的动画转换。现在我们要看看是怎么传递数据的。很可能你已经在UIKit预定义的转场里用到了这个流程。</p><p>在我们开发的演示app中，我们不会在一个视图控制器之间传递重要的数据。我们将简单的发送一个字符串值给对方，会在我们早先在ViewController和SecondViewController场景里添加的第二个标签上显示。</p><p>首先，打开SecondViewController.swift文件。添加以下的在IBOutlet属性之后的属性声明：</p><div><div id="highlighter_264993" class="syntaxhighlighter  js"><table border="0" cellpadding="0" cellspacing="0"><tbody><tr><td class="gutter"><div class="line number1 index0 alt2">1</div></td><td class="code"><div class="container"><div class="line number1 index0 alt2"><code class="js keyword">var</code>&nbsp;<code class="js plain">message:&nbsp;NSString!</code></div></div></td></tr></tbody></table></div></div><p>接下来，我们要用这个属性，从ViewController视图到转场执行到的视图控制器，传递一个字符串值。</p><p>打开ViewController.swift文件，在类里，添加以下方法的实现：</p><div><div id="highlighter_775994" class="syntaxhighlighter  js"><table border="0" cellpadding="0" cellspacing="0"><tbody><tr><td class="gutter"><div class="line number1 index0 alt2">1</div><div class="line number2 index1 alt1">2</div><div class="line number3 index2 alt2">3</div><div class="line number4 index3 alt1">4</div><div class="line number5 index4 alt2">5</div><div class="line number6 index5 alt1">6</div></td><td class="code"><div class="container"><div class="line number1 index0 alt2"><code class="js plain">override&nbsp;func&nbsp;prepareForSegue(segue:&nbsp;UIStoryboardSegue,&nbsp;sender:&nbsp;AnyObject?)&nbsp;{</code></div><div class="line number2 index1 alt1"><code class="js spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="js keyword">if</code>&nbsp;<code class="js plain">segue.identifier&nbsp;==&nbsp;</code><code class="js string">"idFirstSegue"</code>&nbsp;<code class="js plain">{</code></div><div class="line number3 index2 alt2"><code class="js spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="js plain">let&nbsp;secondViewController&nbsp;=&nbsp;segue.destinationViewController&nbsp;as&nbsp;SecondViewController</code></div><div class="line number4 index3 alt1"><code class="js spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="js plain">secondViewController.message&nbsp;=&nbsp;</code><code class="js string">"Hello&nbsp;from&nbsp;the&nbsp;1st&nbsp;View&nbsp;Controller"</code></div><div class="line number5 index4 alt2"><code class="js spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="js plain">}</code></div><div class="line number6 index5 alt1"><code class="js plain">}</code></div></div></td></tr></tbody></table></div></div><p>上面方法是UIViewController类的一部分。基于我们要执行的转场的identifier，我们访问目标视图控制器，也就是本例中的SecondViewController。然后，给SecondViewController类里的message属性设置字符串消息。</p><p>以上都是你在使用转场的时候需要传递数据到另一个视图控制器所需要的。 是由很简单的方法构成的。</p><p>现在再次打开SecondViewController.swift文件。是时候处理message属性，和展示上面接收到的字符串。在viewDidLoad方法里，添加如下代码：</p><div><div id="highlighter_95386" class="syntaxhighlighter  js"><table border="0" cellpadding="0" cellspacing="0"><tbody><tr><td class="gutter"><div class="line number1 index0 alt2">1</div><div class="line number2 index1 alt1">2</div><div class="line number3 index2 alt2">3</div><div class="line number4 index3 alt1">4</div><div class="line number5 index4 alt2">5</div></td><td class="code"><div class="container"><div class="line number1 index0 alt2"><code class="js plain">override&nbsp;func&nbsp;viewDidLoad()&nbsp;{</code></div><div class="line number2 index1 alt1"><code class="js spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="js plain">...</code></div><div class="line number3 index2 alt2">&nbsp;</div><div class="line number4 index3 alt1"><code class="js spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="js plain">lblMessage.text&nbsp;=&nbsp;message</code></div><div class="line number5 index4 alt2"><code class="js plain">}</code></div></div></td></tr></tbody></table></div></div><p>最后，从第二个视图控制到第一个发送一个字符串值。让我们再次实现上面的方法：</p><div><div id="highlighter_963401" class="syntaxhighlighter  js"><table border="0" cellpadding="0" cellspacing="0"><tbody><tr><td class="gutter"><div class="line number1 index0 alt2">1</div><div class="line number2 index1 alt1">2</div><div class="line number3 index2 alt2">3</div><div class="line number4 index3 alt1">4</div><div class="line number5 index4 alt2">5</div><div class="line number6 index5 alt1">6</div></td><td class="code"><div class="container"><div class="line number1 index0 alt2"><code class="js plain">override&nbsp;func&nbsp;prepareForSegue(segue:&nbsp;UIStoryboardSegue,&nbsp;sender:&nbsp;AnyObject?)&nbsp;{</code></div><div class="line number2 index1 alt1"><code class="js spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="js keyword">if</code>&nbsp;<code class="js plain">segue.identifier&nbsp;==&nbsp;</code><code class="js string">"idFirstSegueUnwind"</code>&nbsp;<code class="js plain">{</code></div><div class="line number3 index2 alt2"><code class="js spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="js plain">let&nbsp;firstViewController&nbsp;=&nbsp;segue.destinationViewController&nbsp;as&nbsp;ViewController</code></div><div class="line number4 index3 alt1"><code class="js spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="js plain">firstViewController.lblMessage.text&nbsp;=&nbsp;</code><code class="js string">"You&nbsp;just&nbsp;came&nbsp;back&nbsp;from&nbsp;the&nbsp;2nd&nbsp;VC"</code></div><div class="line number5 index4 alt2"><code class="js spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="js plain">}</code></div><div class="line number6 index5 alt1"><code class="js plain">}</code></div></div></td></tr></tbody></table></div></div><p>上面的实现中，注意我们是直接访问ViewController类里的消息label的。这是展示视图控制器子视图数据的另一个方法。请注意，这两种情况下有必要通过转场对象访问目标视图控制器。</p><p>这几乎就是在视图控制器之间传递数据的所有步骤了。我们一会创建的第二个自定义转场，你会看到最后一种方法，但这里介绍的是你主要用到的。</p><p>如果你需要的话可以再运行app。这次，两个视图控制器里地第二个label显示了我们传递的字符串值。注意，我们在SecondViewController类里的工作结束了，现在开始我们将关注工程里存在的第三个视图控制器。</p><h2>创建第二个自定义转场</h2><p>之前部分我们讨论到的所有概念，都是你在创建和管理自定义转场里需要的。然而，我认为再创建一个可以让一切更容易消化理解，我们也可以看到一些不同的东西。所有，让我们开始吧。</p><p>第一步，要在Interface Builder里创建自定义转场，所以在工程导航器里的Main.storyboard文件里打开它。</p><p>界面再次出现在屏幕上，打开文档大纲板（如果是闭合的话）。点击ViewController场景里的ViewController对象，通过按住Ctrl和鼠标，拖动到ThirdViewController场景里的ThirdViewController对象。将会出现一个蓝色的连接线：</p><p style="text-align:center"><img style="max-width:580px" src="./iOS 8自定义动画转场上手指南 - CocoaChina 苹果开发中文站 - 最热的iPhone开发社区 最热的苹果开发社区 最热的iPad开发社区_files/1422240372470448.png" title="1422240372470448.png" alt="t26_32_second_segue_connect.png"></p><p>在弹出的窗口里，选择custom转场。做完之后，确保我们刚创建的转场在你的画布中看起来是这样的：</p><p style="text-align:center"><img style="max-width:580px" src="./iOS 8自定义动画转场上手指南 - CocoaChina 苹果开发中文站 - 最热的iPhone开发社区 最热的苹果开发社区 最热的iPad开发社区_files/1422240386127113.png" title="1422240386127113.png" alt="t26_33_second_segue_line.png"></p><p>点击上面的线，在工具板里打开属性检查器。这里你要指定两个东西：转场标示符和它的类。对标示符，在Identifier字段里设置idSecondSegue值。在Segue Class字段里，键入SecondCustomSegue的值，让app知道在执行新的自定义转场的时候要用到的类。</p><p style="text-align:center"><img style="max-width:580px" src="./iOS 8自定义动画转场上手指南 - CocoaChina 苹果开发中文站 - 最热的iPhone开发社区 最热的苹果开发社区 最热的iPad开发社区_files/1422240404997251.png" title="1422240404997251.png" alt="t26_34_second_segue_settings.png"></p><p>第二个自定义转场已经创建好了，接下来实现我们想看到的动画转换。</p><h2>实现第二个自定义转场</h2><p>正如我在引言里所说，子类化UIStoryboardSegue类，重载perform方法，你可以自由地实现你想要的任何转换。你可以有简单地动画转换，也可以是复杂的，或者完全没有动画（但是为什么要创建一个自定义转场不应用任何自定义动画效果呢？）。</p><p>这个转场我们将指定另一种转换到第三个视图控制器的动画。这次，我们将实现缩小和放大的效果。具体来说，ViewController视图控制器的视图通过按比例缩小视图来消失，这会导致缩小的效果。另一方面，第三个视图控制器的视图将初始为极小状态，一旦动画执行，它将放大到状态。这会导致放大的效果。教程的概述部分，你可以看到程序运行时的效果。</p><p>现在让我们开始写代码。打开SecondCustomSegue.swift文件，和我们之前两次做的一样的，通过赋给局部变量创建视图控制器的视图的引用。当然，我们的实现将发生在perform方法里：</p><div><div id="highlighter_23041" class="syntaxhighlighter  js"><table border="0" cellpadding="0" cellspacing="0"><tbody><tr><td class="gutter"><div class="line number1 index0 alt2">1</div><div class="line number2 index1 alt1">2</div><div class="line number3 index2 alt2">3</div><div class="line number4 index3 alt1">4</div><div class="line number5 index4 alt2">5</div></td><td class="code"><div class="container"><div class="line number1 index0 alt2"><code class="js plain">override&nbsp;func&nbsp;perform()&nbsp;{</code></div><div class="line number2 index1 alt1"><code class="js spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="js keyword">var</code>&nbsp;<code class="js plain">firstVCView&nbsp;=&nbsp;sourceViewController.view&nbsp;as&nbsp;UIView!</code></div><div class="line number3 index2 alt2"><code class="js spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="js keyword">var</code>&nbsp;<code class="js plain">thirdVCView&nbsp;=&nbsp;destinationViewController.view&nbsp;as&nbsp;UIView!</code></div><div class="line number4 index3 alt1">&nbsp;</div><div class="line number5 index4 alt2"><code class="js plain">}</code></div></div></td></tr></tbody></table></div></div><p>注意，你可以跳过此步，直接用源和目标视图控制器属性里的视图。然而，我认为那样的话会更清晰，尽管会需要更多几行的代码。</p><p>现在，我们把第三个视图控制器的视图加到窗口上。这是你应该做的事，否则就没有转换过渡到得第二个视图了。</p><div><div id="highlighter_415051" class="syntaxhighlighter  js"><table border="0" cellpadding="0" cellspacing="0"><tbody><tr><td class="gutter"><div class="line number1 index0 alt2">1</div><div class="line number2 index1 alt1">2</div><div class="line number3 index2 alt2">3</div><div class="line number4 index3 alt1">4</div><div class="line number5 index4 alt2">5</div><div class="line number6 index5 alt1">6</div><div class="line number7 index6 alt2">7</div></td><td class="code"><div class="container"><div class="line number1 index0 alt2"><code class="js plain">override&nbsp;func&nbsp;perform()&nbsp;{</code></div><div class="line number2 index1 alt1"><code class="js spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="js plain">...</code></div><div class="line number3 index2 alt2">&nbsp;</div><div class="line number4 index3 alt1"><code class="js spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="js plain">let&nbsp;window&nbsp;=&nbsp;UIApplication.sharedApplication().keyWindow</code></div><div class="line number5 index4 alt2"><code class="js spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="js plain">window?.insertSubview(thirdVCView,&nbsp;belowSubview:&nbsp;firstVCView)</code></div><div class="line number6 index5 alt1">&nbsp;</div><div class="line number7 index6 alt2"><code class="js plain">}</code></div></div></td></tr></tbody></table></div></div><p>现在，我们可以指定第三个视图控制器的视图的初始状态。我们不动它的结构（frame），我们修改transform属性，代码如下：</p><div><div id="highlighter_160640" class="syntaxhighlighter  js"><table border="0" cellpadding="0" cellspacing="0"><tbody><tr><td class="gutter"><div class="line number1 index0 alt2">1</div><div class="line number2 index1 alt1">2</div><div class="line number3 index2 alt2">3</div><div class="line number4 index3 alt1">4</div><div class="line number5 index4 alt2">5</div><div class="line number6 index5 alt1">6</div></td><td class="code"><div class="container"><div class="line number1 index0 alt2"><code class="js plain">override&nbsp;func&nbsp;perform()&nbsp;{</code></div><div class="line number2 index1 alt1"><code class="js spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="js plain">...</code></div><div class="line number3 index2 alt2">&nbsp;</div><div class="line number4 index3 alt1"><code class="js spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="js plain">thirdVCView.transform&nbsp;=&nbsp;CGAffineTransformScale(thirdVCView.transform,&nbsp;0.001,&nbsp;0.001)</code></div><div class="line number5 index4 alt2">&nbsp;</div><div class="line number6 index5 alt1"><code class="js plain">}</code></div></div></td></tr></tbody></table></div></div><p>正如你看到的，我们按比例缩小它的宽和高。我们不设置为零，因为这样就完全没效果了。一个很小的值也是有利于我们的目的的。</p><p>下一步就是执行动画。本例中，我们应用两个连续的动画，第一个是缩小源视图，然后是放大目标视图。</p><div><div id="highlighter_259978" class="syntaxhighlighter  js"><table border="0" cellpadding="0" cellspacing="0"><tbody><tr><td class="gutter"><div class="line number1 index0 alt2">1</div><div class="line number2 index1 alt1">2</div><div class="line number3 index2 alt2">3</div><div class="line number4 index3 alt1">4</div><div class="line number5 index4 alt2">5</div><div class="line number6 index5 alt1">6</div><div class="line number7 index6 alt2">7</div><div class="line number8 index7 alt1">8</div><div class="line number9 index8 alt2">9</div><div class="line number10 index9 alt1">10</div><div class="line number11 index10 alt2">11</div><div class="line number12 index11 alt1">12</div><div class="line number13 index12 alt2">13</div><div class="line number14 index13 alt1">14</div><div class="line number15 index14 alt2">15</div><div class="line number16 index15 alt1">16</div><div class="line number17 index16 alt2">17</div><div class="line number18 index17 alt1">18</div></td><td class="code"><div class="container"><div class="line number1 index0 alt2"><code class="js plain">override&nbsp;func&nbsp;perform()&nbsp;{</code></div><div class="line number2 index1 alt1"><code class="js spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="js plain">...</code></div><div class="line number3 index2 alt2">&nbsp;</div><div class="line number4 index3 alt1"><code class="js spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="js plain">UIView.animateWithDuration(0.5,&nbsp;animations:&nbsp;{&nbsp;()&nbsp;-&gt;&nbsp;Void&nbsp;</code><code class="js keyword">in</code>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</div><div class="line number5 index4 alt2"><code class="js spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="js plain">firstVCView.transform&nbsp;=&nbsp;CGAffineTransformScale(thirdVCView.transform,&nbsp;0.001,&nbsp;0.001)&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code></div><div class="line number6 index5 alt1">&nbsp;</div><div class="line number7 index6 alt2"><code class="js spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="js plain">})&nbsp;{&nbsp;(Finished)&nbsp;-&gt;&nbsp;Void&nbsp;</code><code class="js keyword">in</code></div><div class="line number8 index7 alt1">&nbsp;</div><div class="line number9 index8 alt2"><code class="js spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="js plain">UIView.animateWithDuration(0.5,&nbsp;animations:&nbsp;{&nbsp;()&nbsp;-&gt;&nbsp;Void&nbsp;</code><code class="js keyword">in</code></div><div class="line number10 index9 alt1"><code class="js spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="js plain">thirdVCView.transform&nbsp;=&nbsp;CGAffineTransformIdentity</code></div><div class="line number11 index10 alt2">&nbsp;</div><div class="line number12 index11 alt1"><code class="js spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="js plain">},&nbsp;completion:&nbsp;{&nbsp;(Finished)&nbsp;-&gt;&nbsp;Void&nbsp;</code><code class="js keyword">in</code></div><div class="line number13 index12 alt2">&nbsp;</div><div class="line number14 index13 alt1"><code class="js spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="js plain">firstVCView.transform&nbsp;=&nbsp;CGAffineTransformIdentity</code></div><div class="line number15 index14 alt2"><code class="js spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="js plain">self.sourceViewController.presentViewController(self.destinationViewController&nbsp;as&nbsp;UIViewController,&nbsp;animated:&nbsp;</code><code class="js keyword">false</code><code class="js plain">,&nbsp;completion:&nbsp;nil)</code></div><div class="line number16 index15 alt1"><code class="js spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="js plain">})</code></div><div class="line number17 index16 alt2"><code class="js spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="js plain">}</code></div><div class="line number18 index17 alt1"><code class="js plain">}</code></div></div></td></tr></tbody></table></div></div><p>动画发生的时候，第一个视图变小了，看起来像缩小的效果。在completion handler当中，我们将对目标视图控制器反转上面的动画。最后，动画结束后，我们把第一个视图恢复到正常状态，然后展示第三个视图控制器。</p><p>这是整个方法：</p><div><div id="highlighter_194931" class="syntaxhighlighter  js"><table border="0" cellpadding="0" cellspacing="0"><tbody><tr><td class="gutter"><div class="line number1 index0 alt2">1</div><div class="line number2 index1 alt1">2</div><div class="line number3 index2 alt2">3</div><div class="line number4 index3 alt1">4</div><div class="line number5 index4 alt2">5</div><div class="line number6 index5 alt1">6</div><div class="line number7 index6 alt2">7</div><div class="line number8 index7 alt1">8</div><div class="line number9 index8 alt2">9</div><div class="line number10 index9 alt1">10</div><div class="line number11 index10 alt2">11</div><div class="line number12 index11 alt1">12</div><div class="line number13 index12 alt2">13</div><div class="line number14 index13 alt1">14</div><div class="line number15 index14 alt2">15</div><div class="line number16 index15 alt1">16</div><div class="line number17 index16 alt2">17</div><div class="line number18 index17 alt1">18</div><div class="line number19 index18 alt2">19</div><div class="line number20 index19 alt1">20</div><div class="line number21 index20 alt2">21</div><div class="line number22 index21 alt1">22</div><div class="line number23 index22 alt2">23</div><div class="line number24 index23 alt1">24</div><div class="line number25 index24 alt2">25</div></td><td class="code"><div class="container"><div class="line number1 index0 alt2"><code class="js plain">override&nbsp;func&nbsp;perform()&nbsp;{</code></div><div class="line number2 index1 alt1"><code class="js spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="js keyword">var</code>&nbsp;<code class="js plain">firstVCView&nbsp;=&nbsp;sourceViewController.view&nbsp;as&nbsp;UIView!</code></div><div class="line number3 index2 alt2"><code class="js spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="js keyword">var</code>&nbsp;<code class="js plain">thirdVCView&nbsp;=&nbsp;destinationViewController.view&nbsp;as&nbsp;UIView!</code></div><div class="line number4 index3 alt1">&nbsp;</div><div class="line number5 index4 alt2"><code class="js spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="js plain">let&nbsp;window&nbsp;=&nbsp;UIApplication.sharedApplication().keyWindow</code></div><div class="line number6 index5 alt1"><code class="js spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="js plain">window?.insertSubview(thirdVCView,&nbsp;belowSubview:&nbsp;firstVCView)</code></div><div class="line number7 index6 alt2">&nbsp;</div><div class="line number8 index7 alt1"><code class="js spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="js plain">thirdVCView.transform&nbsp;=&nbsp;CGAffineTransformScale(thirdVCView.transform,&nbsp;0.001,&nbsp;0.001)</code></div><div class="line number9 index8 alt2">&nbsp;</div><div class="line number10 index9 alt1"><code class="js spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="js plain">UIView.animateWithDuration(0.5,&nbsp;animations:&nbsp;{&nbsp;()&nbsp;-&gt;&nbsp;Void&nbsp;</code><code class="js keyword">in</code></div><div class="line number11 index10 alt2">&nbsp;</div><div class="line number12 index11 alt1"><code class="js spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="js plain">firstVCView.transform&nbsp;=&nbsp;CGAffineTransformScale(thirdVCView.transform,&nbsp;0.001,&nbsp;0.001)</code></div><div class="line number13 index12 alt2">&nbsp;</div><div class="line number14 index13 alt1"><code class="js spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="js plain">})&nbsp;{&nbsp;(Finished)&nbsp;-&gt;&nbsp;Void&nbsp;</code><code class="js keyword">in</code></div><div class="line number15 index14 alt2">&nbsp;</div><div class="line number16 index15 alt1"><code class="js spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="js plain">UIView.animateWithDuration(0.5,&nbsp;animations:&nbsp;{&nbsp;()&nbsp;-&gt;&nbsp;Void&nbsp;</code><code class="js keyword">in</code></div><div class="line number17 index16 alt2"><code class="js spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="js plain">thirdVCView.transform&nbsp;=&nbsp;CGAffineTransformIdentity</code></div><div class="line number18 index17 alt1">&nbsp;</div><div class="line number19 index18 alt2"><code class="js spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="js plain">},&nbsp;completion:&nbsp;{&nbsp;(Finished)&nbsp;-&gt;&nbsp;Void&nbsp;</code><code class="js keyword">in</code></div><div class="line number20 index19 alt1">&nbsp;</div><div class="line number21 index20 alt2"><code class="js spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="js plain">firstVCView.transform&nbsp;=&nbsp;CGAffineTransformIdentity</code></div><div class="line number22 index21 alt1"><code class="js spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="js plain">self.sourceViewController.presentViewController(self.destinationViewController&nbsp;as&nbsp;UIViewController,&nbsp;animated:&nbsp;</code><code class="js keyword">false</code><code class="js plain">,&nbsp;completion:&nbsp;nil)</code></div><div class="line number23 index22 alt2"><code class="js spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="js plain">})</code></div><div class="line number24 index23 alt1"><code class="js spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="js plain">}</code></div><div class="line number25 index24 alt2"><code class="js plain">}</code></div></div></td></tr></tbody></table></div></div><p>自定义转换准备好了。但是我们还没结束，因为我们必须执行转场。如果你记得，在ViewController场景里有个叫“Tap Me！”的button。这是我们用来启动转场的。</p><p>首先，打开ViewController.swift文件，添加以下的IBAction方法：</p><div><div id="highlighter_402884" class="syntaxhighlighter  js"><table border="0" cellpadding="0" cellspacing="0"><tbody><tr><td class="gutter"><div class="line number1 index0 alt2">1</div><div class="line number2 index1 alt1">2</div><div class="line number3 index2 alt2">3</div></td><td class="code"><div class="container"><div class="line number1 index0 alt2"><code class="js plain">@IBAction&nbsp;func&nbsp;showThirdViewController(sender:&nbsp;AnyObject)&nbsp;{</code></div><div class="line number2 index1 alt1"><code class="js spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="js plain">self.performSegueWithIdentifier(</code><code class="js string">"idSecondSegue"</code><code class="js plain">,&nbsp;sender:&nbsp;self)</code></div><div class="line number3 index2 alt2"><code class="js plain">}</code></div></div></td></tr></tbody></table></div></div><p>如你预期的，我们只是简单地执行转场。注意，转场的标示符的值必须匹配我们在Interface Builder里设置的值。</p><p>最后，我们必须把上面的方法连到按钮上。打开Main.storyboard.swift文件，在文档大纲里的ViewController场景，点在按钮对象上，然后按住Ctrl和鼠标，拖到ViewController对象上：</p><p style="text-align:center"><img style="max-width:580px" src="./iOS 8自定义动画转场上手指南 - CocoaChina 苹果开发中文站 - 最热的iPhone开发社区 最热的苹果开发社区 最热的iPad开发社区_files/1422241018682001.png" title="1422241018682001.png" alt="t26_35_ibaction_method_connect.png"></p><p>出现了一个有很多选项的弹出窗口。里面有个Sent Events，这个下面展示了IBAction方法。选择它，联系就成功完成了。</p><p style="text-align:center"><img style="max-width:580px" src="./iOS 8自定义动画转场上手指南 - CocoaChina 苹果开发中文站 - 最热的iPhone开发社区 最热的苹果开发社区 最热的iPad开发社区_files/1422241031478673.png" title="1422241031478673.png" alt="t26_36_ibaction_method_select.png"></p><p>如果你想限制你可以测试这个app。点在最初的视图控制器的按钮上，观察第三个视图控制器是怎么呈现的。</p><h2>第二个解除转场</h2><p>在演示app里我们实现的第一个解除转场，我说过你应该做的第一件事是IBAction方法的定义，这个方法在转场执行的时候被调用。这里，我们实现这样一个方法，叫returnFromSegueActions(sender:)，一旦处理好后我们也将在新的解除转场中用到它。</p><p>上面意味着我们可以去做下一个步骤，在Interface Builder中创建解除转场。打开Main.storyboard文件，在ThirdViewController场景中，选择ThirdViewController对象，按住Ctrl拖动到Exit对象上。</p><p style="text-align:center"><img style="max-width:580px" src="./iOS 8自定义动画转场上手指南 - CocoaChina 苹果开发中文站 - 最热的iPhone开发社区 最热的苹果开发社区 最热的iPad开发社区_files/1422241101115425.png" title="1422241101115425.png" alt="t26_37_unwind_segue_connect2.png"></p><p>在弹出框里点击操作方法的名字，解除转场就被创建了。</p><p style="text-align:center"><img style="max-width:580px" src="./iOS 8自定义动画转场上手指南 - CocoaChina 苹果开发中文站 - 最热的iPhone开发社区 最热的苹果开发社区 最热的iPad开发社区_files/1422241116576075.png" title="1422241116576075.png" alt="t26_38_unwind_segue_2_created.png"></p><p>接下来，选择那个转场，打开属性监视器，在identifier字段里，设置idSecondSegueUnwind值。</p><p>目前解除转场已经准备好了，我们可以写我们想要的转换行为的代码。这次，我们不仅仅执行完全相反的动画到正常的转场。我们将创建一个有点复杂的动画，第三个视图控制器的视图将被缩小，同时移向屏幕顶端，第一个视图控制器的视图将被放大，从屏幕底部移动到顶端，所以占据了整个可用区域。这个视图最初准备离开屏幕的可视区域。</p><p>打开SecondCustomSegueUnwind.swift文件，我们将最后一次实现perform方法，让我们从简单的开始：</p><div><div id="highlighter_940505" class="syntaxhighlighter  js"><table border="0" cellpadding="0" cellspacing="0"><tbody><tr><td class="gutter"><div class="line number1 index0 alt2">1</div><div class="line number2 index1 alt1">2</div><div class="line number3 index2 alt2">3</div><div class="line number4 index3 alt1">4</div><div class="line number5 index4 alt2">5</div><div class="line number6 index5 alt1">6</div><div class="line number7 index6 alt2">7</div></td><td class="code"><div class="container"><div class="line number1 index0 alt2"><code class="js plain">override&nbsp;func&nbsp;perform()&nbsp;{</code></div><div class="line number2 index1 alt1"><code class="js spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="js keyword">var</code>&nbsp;<code class="js plain">firstVCView&nbsp;=&nbsp;destinationViewController.view&nbsp;as&nbsp;UIView!</code></div><div class="line number3 index2 alt2"><code class="js spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="js keyword">var</code>&nbsp;<code class="js plain">thirdVCView&nbsp;=&nbsp;sourceViewController.view&nbsp;as&nbsp;UIView!</code></div><div class="line number4 index3 alt1">&nbsp;</div><div class="line number5 index4 alt2"><code class="js spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="js plain">let&nbsp;screenHeight&nbsp;=&nbsp;UIScreen.mainScreen().bounds.size.height</code></div><div class="line number6 index5 alt1">&nbsp;</div><div class="line number7 index6 alt2"><code class="js plain">}</code></div></div></td></tr></tbody></table></div></div><p>和平常一样，我们让两个视图控制器的视图保存为局部变量，同时把屏幕的宽和高存储在一个变量里。接下来，指定firstVCView视图的初始状态。就像我说的，首先定义离屏的位置，这个将按比例缩小：</p><div><div id="highlighter_158559" class="syntaxhighlighter  js"><table border="0" cellpadding="0" cellspacing="0"><tbody><tr><td class="gutter"><div class="line number1 index0 alt2">1</div><div class="line number2 index1 alt1">2</div><div class="line number3 index2 alt2">3</div><div class="line number4 index3 alt1">4</div><div class="line number5 index4 alt2">5</div><div class="line number6 index5 alt1">6</div><div class="line number7 index6 alt2">7</div><div class="line number8 index7 alt1">8</div><div class="line number9 index8 alt2">9</div><div class="line number10 index9 alt1">10</div><div class="line number11 index10 alt2">11</div></td><td class="code"><div class="container"><div class="line number1 index0 alt2"><code class="js plain">override&nbsp;func&nbsp;perform()&nbsp;{</code></div><div class="line number2 index1 alt1"><code class="js spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="js plain">...</code></div><div class="line number3 index2 alt2">&nbsp;</div><div class="line number4 index3 alt1"><code class="js spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="js plain">firstVCView.frame&nbsp;=&nbsp;CGRectOffset(firstVCView.frame,&nbsp;0.0,&nbsp;screenHeight)</code></div><div class="line number5 index4 alt2"><code class="js spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="js plain">firstVCView.transform&nbsp;=&nbsp;CGAffineTransformScale(firstVCView.transform,&nbsp;0.001,&nbsp;0.001)</code></div><div class="line number6 index5 alt1">&nbsp;</div><div class="line number7 index6 alt2">&nbsp;</div><div class="line number8 index7 alt1"><code class="js spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="js plain">let&nbsp;window&nbsp;=&nbsp;UIApplication.sharedApplication().keyWindow</code></div><div class="line number9 index8 alt2"><code class="js spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="js plain">window?.insertSubview(firstVCView,&nbsp;aboveSubview:&nbsp;thirdVCView)</code></div><div class="line number10 index9 alt1">&nbsp;</div><div class="line number11 index10 alt2"><code class="js plain">}</code></div></div></td></tr></tbody></table></div></div><p>除了设置初始状态，我们也把视图添加到app的窗口上。</p><p>最后，让我们执行动画。记得要消失的视图按比例缩小，要出现的视图按比例放大，两个视图都往顶部移动。</p><div><div id="highlighter_988766" class="syntaxhighlighter  js"><table border="0" cellpadding="0" cellspacing="0"><tbody><tr><td class="gutter"><div class="line number1 index0 alt2">1</div><div class="line number2 index1 alt1">2</div><div class="line number3 index2 alt2">3</div><div class="line number4 index3 alt1">4</div><div class="line number5 index4 alt2">5</div><div class="line number6 index5 alt1">6</div><div class="line number7 index6 alt2">7</div><div class="line number8 index7 alt1">8</div><div class="line number9 index8 alt2">9</div><div class="line number10 index9 alt1">10</div><div class="line number11 index10 alt2">11</div><div class="line number12 index11 alt1">12</div><div class="line number13 index12 alt2">13</div><div class="line number14 index13 alt1">14</div><div class="line number15 index14 alt2">15</div><div class="line number16 index15 alt1">16</div></td><td class="code"><div class="container"><div class="line number1 index0 alt2"><code class="js plain">override&nbsp;func&nbsp;perform()&nbsp;{</code></div><div class="line number2 index1 alt1"><code class="js spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="js plain">...</code></div><div class="line number3 index2 alt2">&nbsp;</div><div class="line number4 index3 alt1"><code class="js spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="js plain">UIView.animateWithDuration(0.5,&nbsp;animations:&nbsp;{&nbsp;()&nbsp;-&gt;&nbsp;Void&nbsp;</code><code class="js keyword">in</code></div><div class="line number5 index4 alt2">&nbsp;</div><div class="line number6 index5 alt1"><code class="js spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="js plain">thirdVCView.transform&nbsp;=&nbsp;CGAffineTransformScale(thirdVCView.transform,&nbsp;0.001,&nbsp;0.001)</code></div><div class="line number7 index6 alt2"><code class="js spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="js plain">thirdVCView.frame&nbsp;=&nbsp;CGRectOffset(thirdVCView.frame,&nbsp;0.0,&nbsp;-screenHeight)</code></div><div class="line number8 index7 alt1">&nbsp;</div><div class="line number9 index8 alt2"><code class="js spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="js plain">firstVCView.transform&nbsp;=&nbsp;CGAffineTransformIdentity</code></div><div class="line number10 index9 alt1"><code class="js spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="js plain">firstVCView.frame&nbsp;=&nbsp;CGRectOffset(firstVCView.frame,&nbsp;0.0,&nbsp;-screenHeight)</code></div><div class="line number11 index10 alt2">&nbsp;</div><div class="line number12 index11 alt1"><code class="js spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="js plain">})&nbsp;{&nbsp;(Finished)&nbsp;-&gt;&nbsp;Void&nbsp;</code><code class="js keyword">in</code></div><div class="line number13 index12 alt2">&nbsp;</div><div class="line number14 index13 alt1"><code class="js spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="js plain">self.sourceViewController.dismissViewControllerAnimated(</code><code class="js keyword">false</code><code class="js plain">,&nbsp;completion:&nbsp;nil)</code></div><div class="line number15 index14 alt2"><code class="js spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="js plain">}</code></div><div class="line number16 index15 alt1"><code class="js plain">}</code></div></div></td></tr></tbody></table></div></div><p>这就是自定义解除转场的实现。接下来是小结性的代码：</p><div><div id="highlighter_283151" class="syntaxhighlighter  js"><table border="0" cellpadding="0" cellspacing="0"><tbody><tr><td class="gutter"><div class="line number1 index0 alt2">1</div><div class="line number2 index1 alt1">2</div><div class="line number3 index2 alt2">3</div><div class="line number4 index3 alt1">4</div><div class="line number5 index4 alt2">5</div><div class="line number6 index5 alt1">6</div><div class="line number7 index6 alt2">7</div><div class="line number8 index7 alt1">8</div><div class="line number9 index8 alt2">9</div><div class="line number10 index9 alt1">10</div><div class="line number11 index10 alt2">11</div><div class="line number12 index11 alt1">12</div><div class="line number13 index12 alt2">13</div><div class="line number14 index13 alt1">14</div><div class="line number15 index14 alt2">15</div><div class="line number16 index15 alt1">16</div><div class="line number17 index16 alt2">17</div><div class="line number18 index17 alt1">18</div><div class="line number19 index18 alt2">19</div><div class="line number20 index19 alt1">20</div><div class="line number21 index20 alt2">21</div><div class="line number22 index21 alt1">22</div><div class="line number23 index22 alt2">23</div><div class="line number24 index23 alt1">24</div><div class="line number25 index24 alt2">25</div></td><td class="code"><div class="container"><div class="line number1 index0 alt2"><code class="js plain">override&nbsp;func&nbsp;perform()&nbsp;{</code></div><div class="line number2 index1 alt1"><code class="js spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="js keyword">var</code>&nbsp;<code class="js plain">firstVCView&nbsp;=&nbsp;destinationViewController.view&nbsp;as&nbsp;UIView!</code></div><div class="line number3 index2 alt2"><code class="js spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="js keyword">var</code>&nbsp;<code class="js plain">thirdVCView&nbsp;=&nbsp;sourceViewController.view&nbsp;as&nbsp;UIView!</code></div><div class="line number4 index3 alt1">&nbsp;</div><div class="line number5 index4 alt2"><code class="js spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="js plain">let&nbsp;screenHeight&nbsp;=&nbsp;UIScreen.mainScreen().bounds.size.height</code></div><div class="line number6 index5 alt1">&nbsp;</div><div class="line number7 index6 alt2"><code class="js spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="js plain">firstVCView.frame&nbsp;=&nbsp;CGRectOffset(firstVCView.frame,&nbsp;0.0,&nbsp;screenHeight)</code></div><div class="line number8 index7 alt1"><code class="js spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="js plain">firstVCView.transform&nbsp;=&nbsp;CGAffineTransformScale(firstVCView.transform,&nbsp;0.001,&nbsp;0.001)</code></div><div class="line number9 index8 alt2">&nbsp;</div><div class="line number10 index9 alt1"><code class="js spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="js plain">let&nbsp;window&nbsp;=&nbsp;UIApplication.sharedApplication().keyWindow</code></div><div class="line number11 index10 alt2"><code class="js spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="js plain">window?.insertSubview(firstVCView,&nbsp;aboveSubview:&nbsp;thirdVCView)</code></div><div class="line number12 index11 alt1">&nbsp;</div><div class="line number13 index12 alt2"><code class="js spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="js plain">UIView.animateWithDuration(0.5,&nbsp;animations:&nbsp;{&nbsp;()&nbsp;-&gt;&nbsp;Void&nbsp;</code><code class="js keyword">in</code></div><div class="line number14 index13 alt1">&nbsp;</div><div class="line number15 index14 alt2"><code class="js spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="js plain">thirdVCView.transform&nbsp;=&nbsp;CGAffineTransformScale(thirdVCView.transform,&nbsp;0.001,&nbsp;0.001)</code></div><div class="line number16 index15 alt1"><code class="js spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="js plain">thirdVCView.frame&nbsp;=&nbsp;CGRectOffset(thirdVCView.frame,&nbsp;0.0,&nbsp;-screenHeight)</code></div><div class="line number17 index16 alt2">&nbsp;</div><div class="line number18 index17 alt1"><code class="js spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="js plain">firstVCView.transform&nbsp;=&nbsp;CGAffineTransformIdentity</code></div><div class="line number19 index18 alt2"><code class="js spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="js plain">firstVCView.frame&nbsp;=&nbsp;CGRectOffset(firstVCView.frame,&nbsp;0.0,&nbsp;-screenHeight)</code></div><div class="line number20 index19 alt1">&nbsp;</div><div class="line number21 index20 alt2"><code class="js spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="js plain">})&nbsp;{&nbsp;(Finished)&nbsp;-&gt;&nbsp;Void&nbsp;</code><code class="js keyword">in</code></div><div class="line number22 index21 alt1">&nbsp;</div><div class="line number23 index22 alt2"><code class="js spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="js plain">self.sourceViewController.dismissViewControllerAnimated(</code><code class="js keyword">false</code><code class="js plain">,&nbsp;completion:&nbsp;nil)</code></div><div class="line number24 index23 alt1"><code class="js spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="js plain">}</code></div><div class="line number25 index24 alt2"><code class="js plain">}</code></div></div></td></tr></tbody></table></div></div><p>再次回到ViewController.swift文件，让我们看下segueForUnwindingToViewController(toViewController:fromViewController:identifier:) 方法，我们已经讨论过它了，现在我们必须检查新的解除转场，所以我们初始化，然后返回一个子类的转场对象。根据我们之前说的，我们将再创建一个用例，检查转场的标示符是否和解除转场的匹配，然后再继续。通过添加如下代码修改方法：</p><div><div id="highlighter_323906" class="syntaxhighlighter  js"><table border="0" cellpadding="0" cellspacing="0"><tbody><tr><td class="gutter"><div class="line number1 index0 alt2">1</div><div class="line number2 index1 alt1">2</div><div class="line number3 index2 alt2">3</div><div class="line number4 index3 alt1">4</div><div class="line number5 index4 alt2">5</div><div class="line number6 index5 alt1">6</div><div class="line number7 index6 alt2">7</div><div class="line number8 index7 alt1">8</div><div class="line number9 index8 alt2">9</div><div class="line number10 index9 alt1">10</div><div class="line number11 index10 alt2">11</div><div class="line number12 index11 alt1">12</div><div class="line number13 index12 alt2">13</div><div class="line number14 index13 alt1">14</div><div class="line number15 index14 alt2">15</div><div class="line number16 index15 alt1">16</div><div class="line number17 index16 alt2">17</div></td><td class="code"><div class="container"><div class="line number1 index0 alt2"><code class="js plain">override&nbsp;func&nbsp;segueForUnwindingToViewController(toViewController:&nbsp;UIViewController,&nbsp;fromViewController:&nbsp;UIViewController,&nbsp;identifier:&nbsp;String?)&nbsp;-&gt;&nbsp;UIStoryboardSegue&nbsp;{</code></div><div class="line number2 index1 alt1"><code class="js spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="js keyword">if</code>&nbsp;<code class="js plain">let&nbsp;id&nbsp;=&nbsp;identifier{</code></div><div class="line number3 index2 alt2"><code class="js spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="js plain">...</code></div><div class="line number4 index3 alt1"><code class="js spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="js keyword">else</code>&nbsp;<code class="js keyword">if</code>&nbsp;<code class="js plain">id&nbsp;==&nbsp;</code><code class="js string">"idSecondSegueUnwind"</code>&nbsp;<code class="js plain">{</code></div><div class="line number5 index4 alt2"><code class="js spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="js plain">let&nbsp;unwindSegue&nbsp;=&nbsp;SecondCustomSegueUnwind(identifier:&nbsp;id,</code></div><div class="line number6 index5 alt1"><code class="js spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="js plain">source:&nbsp;fromViewController,</code></div><div class="line number7 index6 alt2"><code class="js spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="js plain">destination:&nbsp;toViewController,</code></div><div class="line number8 index7 alt1"><code class="js spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="js plain">performHandler:&nbsp;{&nbsp;()&nbsp;-&gt;&nbsp;Void&nbsp;</code><code class="js keyword">in</code></div><div class="line number9 index8 alt2">&nbsp;</div><div class="line number10 index9 alt1"><code class="js spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="js plain">})</code></div><div class="line number11 index10 alt2">&nbsp;</div><div class="line number12 index11 alt1"><code class="js spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="js keyword">return</code>&nbsp;<code class="js plain">unwindSegue</code></div><div class="line number13 index12 alt2"><code class="js spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="js plain">}&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code></div><div class="line number14 index13 alt1"><code class="js spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="js plain">}</code></div><div class="line number15 index14 alt2">&nbsp;</div><div class="line number16 index15 alt1"><code class="js spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="js plain">...</code></div><div class="line number17 index16 alt2"><code class="js plain">}</code></div></div></td></tr></tbody></table></div></div><p>这没有什么新的或者难的地方。现在新的解除转场可以完全执行了。然而，我们必须先启动，通过在第三个视图控制器里添加新的向上滑动的手势来管理它。所以，到ThirdViewController.swift文件，在viewDidLoad文件里添加如下代码：</p><div><div id="highlighter_964532" class="syntaxhighlighter  js"><table border="0" cellpadding="0" cellspacing="0"><tbody><tr><td class="gutter"><div class="line number1 index0 alt2">1</div><div class="line number2 index1 alt1">2</div><div class="line number3 index2 alt2">3</div><div class="line number4 index3 alt1">4</div><div class="line number5 index4 alt2">5</div><div class="line number6 index5 alt1">6</div><div class="line number7 index6 alt2">7</div></td><td class="code"><div class="container"><div class="line number1 index0 alt2"><code class="js plain">override&nbsp;func&nbsp;viewDidLoad()&nbsp;{</code></div><div class="line number2 index1 alt1"><code class="js spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="js plain">...</code></div><div class="line number3 index2 alt2">&nbsp;</div><div class="line number4 index3 alt1"><code class="js spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="js keyword">var</code>&nbsp;<code class="js plain">swipeGestureRecognizer:&nbsp;UISwipeGestureRecognizer&nbsp;=&nbsp;UISwipeGestureRecognizer(target:&nbsp;self,&nbsp;action:&nbsp;</code><code class="js string">"showFirstViewController"</code><code class="js plain">)</code></div><div class="line number5 index4 alt2"><code class="js spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="js plain">swipeGestureRecognizer.direction&nbsp;=&nbsp;UISwipeGestureRecognizerDirection.Up</code></div><div class="line number6 index5 alt1"><code class="js spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="js plain">self.view.addGestureRecognizer(swipeGestureRecognizer)</code></div><div class="line number7 index6 alt2"><code class="js plain">}</code></div></div></td></tr></tbody></table></div></div><p>我们只剩下去实现showFirstViewController方法，和其它类似方法一样简单：</p><div><div id="highlighter_444484" class="syntaxhighlighter  js"><table border="0" cellpadding="0" cellspacing="0"><tbody><tr><td class="gutter"><div class="line number1 index0 alt2">1</div><div class="line number2 index1 alt1">2</div><div class="line number3 index2 alt2">3</div></td><td class="code"><div class="container"><div class="line number1 index0 alt2"><code class="js plain">func&nbsp;showFirstViewController()&nbsp;{</code></div><div class="line number2 index1 alt1"><code class="js spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="js plain">self.performSegueWithIdentifier(</code><code class="js string">"idSecondSegueUnwind"</code><code class="js plain">,&nbsp;sender:&nbsp;self)</code></div><div class="line number3 index2 alt2"><code class="js plain">}</code></div></div></td></tr></tbody></table></div></div><p>现在，运行这个差不多完全实现的应用之前，为什么不在第三个视图控制器消失的时候显示一条消息呢？</p><p>当然可以。不过，和之前的方法不同，我们在IBAction这个方法returnFromSegueActions(sender:)里传递数据。我们已经给它添加了一些简单的代码，我们也说了这个方法是随着解除转场用来执行各种动作的。</p><p>打开ViewController.swift文件，找到上述方法，这里，添加以下的else代码：</p><div><div id="highlighter_118361" class="syntaxhighlighter  js"><table border="0" cellpadding="0" cellspacing="0"><tbody><tr><td class="gutter"><div class="line number1 index0 alt2">1</div><div class="line number2 index1 alt1">2</div><div class="line number3 index2 alt2">3</div><div class="line number4 index3 alt1">4</div><div class="line number5 index4 alt2">5</div><div class="line number6 index5 alt1">6</div><div class="line number7 index6 alt2">7</div></td><td class="code"><div class="container"><div class="line number1 index0 alt2"><code class="js plain">@IBAction&nbsp;func&nbsp;returnFromSegueActions(sender:&nbsp;UIStoryboardSegue){</code></div><div class="line number2 index1 alt1"><code class="js spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="js plain">...</code></div><div class="line number3 index2 alt2">&nbsp;</div><div class="line number4 index3 alt1"><code class="js spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="js keyword">else</code><code class="js plain">{</code></div><div class="line number5 index4 alt2"><code class="js spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="js plain">self.lblMessage.text&nbsp;=&nbsp;</code><code class="js string">"Welcome&nbsp;back!"</code></div><div class="line number6 index5 alt1"><code class="js spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="js plain">}</code></div><div class="line number7 index6 alt2"><code class="js plain">}</code></div></div></td></tr></tbody></table></div></div><p>上面添加的消息将每次显示到第一个视图控制器上，第二个解除转场被执行。</p><h2>运行应用程序</h2><p>现在我们的演示app完成了。你可以去测试了，当然，如果你想更熟悉自定义转场你可以随意修改任一部分。下面再次展示了app运行的动画。</p><p style="text-align:center"><img style="max-width:580px" src="./iOS 8自定义动画转场上手指南 - CocoaChina 苹果开发中文站 - 最热的iPhone开发社区 最热的苹果开发社区 最热的iPad开发社区_files/1421999721366749.gif" title="1421999721366749.gif" alt="final_sample.gif"></p><h2>总结</h2><p>如果你快速回顾下我们在教程所做的，你肯定会得出这样的结论：使用自定义转场并不难。在视图控制器间应用自定义动画转换，可以有很好的用户体验，也使得你的app和其他的与众不同。如果自定义转场对你来说是新的东西，去学习使用他们。我强烈建议你这么做。我们实现的演示app可以指导你以正确的方式实现自定义转场和解除转场。我们创建和应用的动画并不复杂，但足够你理解所有的知识点。发挥你的想象力，创造更炫的效果。希望你能喜欢这篇文章，也希望它能派上用场。一如既往的，我们等待你的想法。</p><p>供您参考，您可以在<a href="https://www.dropbox.com/s/tfxlj1py3e8rbhl/CustomSegues.zip?dl=0" target="_blank">这里</a>下载项目。<br>（本文为CocoaChina组织翻译，本译文权利归译者所有，未经允许禁止转载。）</p>
			</div>
			<div id="page" style="padding:0"></div>
                
			<div class="wx_article">	
				<div class="article_weixin">				
					<img src="./iOS 8自定义动画转场上手指南 - CocoaChina 苹果开发中文站 - 最热的iPhone开发社区 最热的苹果开发社区 最热的iPad开发社区_files/article_weixin.jpg" width="131" height="131" alt="搜索CocoaChina微信公众号：CocoaChina">
					<div class="article_scan">微信扫一扫</div>
					<div class="article_txt"><span style="color:#999999">订阅每日移动开发及APP推广热点资讯<br>公众号：</span>CocoaChina</div>
				</div>
			</div>
			
		   <div class="clearfix tgbox">
				<a href="http://www.cocoachina.com/deliver.php" class="tg float-l" target="_blank">我要投稿</a>&nbsp;&nbsp;
				<a style="margin-left:10px" href="javascript:void(0)" onclick="add_favors(11011,&#39;iOS 8自定义动画转场上手指南&#39;)" class="tg float-l">收藏文章</a>
				<div class="share float-r">分享到：
					<div class="bdsharebuttonbox" id="sharediv"><a href="http://www.cocoachina.com/ios/20150126/11011.html#" class="bds_more" data-cmd="more"></a> <a href="http://www.cocoachina.com/ios/20150126/11011.html#" class="bds_qzone" data-cmd="qzone" title="分享到QQ空间"></a><a href="http://www.cocoachina.com/ios/20150126/11011.html#" class="bds_tsina" data-cmd="tsina" title="分享到新浪微博"></a> <a href="http://www.cocoachina.com/ios/20150126/11011.html#" class="bds_weixin" data-cmd="weixin" title="分享到微信"></a></div>
				</div>
			</div>			
			
			
			<a class="zanbox" href="javascript:void(0)" id="zanbox" onclick="postDigg(&#39;good&#39;,11011)" title="哎呦，不错噢，赞一个">
				<strong id="newdigg">
				 <script src="./iOS 8自定义动画转场上手指南 - CocoaChina 苹果开发中文站 - 最热的iPhone开发社区 最热的苹果开发社区 最热的iPad开发社区_files/count(2).php" language="javascript"></script>29
				</strong>
			</a>			
		</div>
    
        	<div class="article-prev">上一篇：<a href="http://www.cocoachina.com/ios/20150123/11003.html">【知识梳理向】Objective-C中的@property</a> </div>
            <div class="article-next">下一篇：<a href="http://www.cocoachina.com/ios/20150126/11019.html">Apple Pay编程指南</a> </div>
      	
		<!--相关资讯-->
		<div class="part-wrap clearfix">
			<h3>相关资讯</h3>
			<ul class="info-list clearfix">
            	<li>
                	<a href="http://www.cocoachina.com/ios/20150605/11998.html" target="_blank" title="在这个教程中，你将会学习用Swift实现这个很酷的动画。在这个过程中，你将会用到图形图层、遮罩、theUIViewControllerAnimatedTransitioning协议,以及UIPercentDrivenInteractiveTransition类等等">如何实现Ping App的转场动画</a>          
             	</li>
<li>
                	<a href="http://www.cocoachina.com/ios/20150311/11301.html" target="_blank" title="尽管苹果把iCloud与CoreData之间的完美配合吹的天花乱坠，但在iOS7之前，想用iCloud同步CoreData数据简直就是噩梦，苹果自己也承认了之前的诸多bug和不稳定性，这让苹果不得不重新站出来说他们的工程师">CoreData遇见iCloud的那些坑</a>          
             	</li>
<li>
                	<a href="http://www.cocoachina.com/ios/20150311/11300.html" target="_blank" title="一直需要一个 Log 系统，可以将程序运行过程中打的 log 发送到自己服务器，方便之后数据分析或者除错。自己做的话，也很简单。
">利用 CocoaLumberjack 搭建自己的 Log 系统</a>          
             	</li>
<li>
                	<a href="http://www.cocoachina.com/ios/20150311/11296.html" target="_blank" title="第一台 iPhone 问世就装有相机。在第一个 SKDs 版本中，在 app 里面整合相机的唯一方法就是使用 UIImagePickerController，但到了 iOS 4，发布了更灵活的 AVFoundation 框架。在这篇文章里，我们将会看到如何使用">objc.io#21#iOS 上的相机捕捉</a>          
             	</li>
<li>
                	<a href="http://www.cocoachina.com/ios/20150205/11108.html" target="_blank" title="在第一部分中，我们了解了WebKit框架的基础部分。在本篇文章中，我们会深入了解WebKit框架并学习如何在原生App中定制网页。我们也会学习如何从网页中获得数据，并在App中使用数据">iOS 8 WebKit框架概览（下）</a>          
             	</li>
<li>
                	<a href="http://www.cocoachina.com/ios/20150203/11089.html" target="_blank" title="iOS 8引入了一个新的框架——WebKit，在WebKit框架中，有WKWebView可以替换UIKit的UIWebView和AppKit的WebView，而且提供了在两个平台可以一致使用的接口，开发者可以在原生App中使用Nitro来提高网页的性能和表现">iOS 8 WebKit框架概览（上）</a>          
             	</li>
<li>
                	<a href="http://www.cocoachina.com/ios/20150122/10978.html" target="_blank" title="Photo Editing Extension 允许用户在 Photos 应用里使用第三方应用编辑照片或视频。本篇文章里我们一起来看看怎样制作一个 Photo Editing Extension">理解 iOS 8 中的 Photo Editing Extension</a>          
             	</li>
<li>
                	<a href="http://www.cocoachina.com/ios/20150115/10926.html" target="_blank" title="Handoff的基本思想就是：用户在一个应用里所做的任何操作都包含着一个activity，一个activity可以和一个特定用户的多台设备关联起来。用行话来说，抽象出这种activity的类叫做NSUserActivity，大部分时间我">iOS 8 Handoff 开发指南</a>          
             	</li>
<li>
                	<a href="http://www.cocoachina.com/ios/20150108/10864.html" target="_blank" title="距iOS 8 和 iPhone 6/6 Plus发布已经过了一段时间，想必现在大家已经为它们做过适配了，不过你仍然可以看看翻译自raywenderlich的这篇文章，来检查一下有没有什么缺漏？">App适配iPhone 6/ Plus和iOS 8：10条小秘诀</a>          
             	</li>
<li>
                	<a href="http://www.cocoachina.com/ios/20141218/10687.html" target="_blank" title="在使用 table view 的时侯经常会遇到这样的需求：table view 的 cell 中的内容是动态的，导致在开发的时候不知道一个 cell 的高度具体是多少，所以需要提供一个计算 cell 高度的算法，在每次加载到这个 ">iOS 8 自适应 Cell</a>          
             	</li>
			
			</ul>
		</div>  
		<div class="clearfix" style="margin-top:20px;">
			<script async="" src="http://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
			<!-- CC评论框 -->
			<ins class="adsbygoogle" style="display:inline-block;width:750px;height:90px" data-ad-client="ca-pub-1180518835303646" data-ad-slot="8242010366"></ins>
			<script>
				(adsbygoogle = window.adsbygoogle || []).push({});
			</script>					
		</div>		
		<iframe id="comiframe" src="./iOS 8自定义动画转场上手指南 - CocoaChina 苹果开发中文站 - 最热的iPhone开发社区 最热的苹果开发社区 最热的iPad开发社区_files/get_comments.html" width="750" frameborder="0" scrolling="no" height="1244"></iframe>
		<script type="text/javascript">
			var reinit;

			function reinitIframe(){
				var iframe = document.getElementById("comiframe");
				var src = $("#comiframe").attr('src');
				try{
				var indexof = src.indexOf("cn.cocos2d-x.org/comment/get_comments");
				if(src!='' && indexof<0 ){
					var bHeight = iframe.contentWindow.document.body.scrollHeight;
					
					var dHeight = iframe.contentWindow.document.documentElement.scrollHeight;
				
					var height = Math.max(bHeight, dHeight);
					iframe.height =  parseInt(height)+180;
					if(height!='150'){
					var src_new=src.replace("www.cocoachina.com/comment.php","cn.cocos2d-x.org/comment/get_comments");
					$("#comiframe").attr("src",src_new);

					clearInterval(reinit);
					}
				}
				}catch(ex){
				}
			}
			reinit = window.setInterval("reinitIframe()", 1200);
		</script>	
		
		
	</div>
    <!--./left-->
            <!--侧边栏-->
            <div class="clearfix newslist">
                <div class="rightSide detail-right float-r">                                       
                    <!--两周热门资讯推荐-->
                    <div> 
                        <div class="part-wrap clearfix">
                            <h3>热门资讯</h3>
                            <ul class="related-hot">
								<li class="clearfix"><a href="http://www.cocoachina.com/ios/20150617/12165.html" class="float-l pic" target="_blank" title="10步成为专业iOS开发者——从零起步"><img src="./iOS 8自定义动画转场上手指南 - CocoaChina 苹果开发中文站 - 最热的iPhone开发社区 最热的苹果开发社区 最热的iPad开发社区_files/5699843173e06f60a0d9028f119394b5.jpg" style="max-height:60px" alt="10步成为专业iOS开发者——从零起步"></a><div style="margin-left:86px"><p class="related-intro"><a href="http://www.cocoachina.com/ios/20150617/12165.html" target="_blank" title="10步成为专业iOS开发者——从零起步">10步成为专业iOS开发者——从零起步</a></p><p class="hits">点击量<span>18271</span></p></div></li><li class="clearfix"><a href="http://www.cocoachina.com/ios/20150623/12233.html" class="float-l pic" target="_blank" title="iOS 9: UIStackView入门"><img src="./iOS 8自定义动画转场上手指南 - CocoaChina 苹果开发中文站 - 最热的iPhone开发社区 最热的苹果开发社区 最热的iPad开发社区_files/6a487c388bb8263bc0291f347633352a.jpg" style="max-height:60px" alt="iOS 9: UIStackView入门"></a><div style="margin-left:86px"><p class="related-intro"><a href="http://www.cocoachina.com/ios/20150623/12233.html" target="_blank" title="iOS 9: UIStackView入门">iOS 9: UIStackView入门</a></p><p class="hits">点击量<span>8028</span></p></div></li><li class="clearfix"><a href="http://www.cocoachina.com/ios/20150616/12167.html" class="float-l pic" target="_blank" title="WWDC 2015上那些酷酷的新内容（二）"><img src="./iOS 8自定义动画转场上手指南 - CocoaChina 苹果开发中文站 - 最热的iPhone开发社区 最热的苹果开发社区 最热的iPad开发社区_files/473f7ddfd934b33d73c697e7ec443950.jpg" style="max-height:60px" alt="WWDC 2015上那些酷酷的新内容（二）"></a><div style="margin-left:86px"><p class="related-intro"><a href="http://www.cocoachina.com/ios/20150616/12167.html" target="_blank" title="WWDC 2015上那些酷酷的新内容（二）">WWDC 2015上那些酷酷的新内容（二）</a></p><p class="hits">点击量<span>6456</span></p></div></li><li class="clearfix"><a href="http://www.cocoachina.com/ios/20150626/11348.html" class="float-l pic" target="_blank" title="11个超棒的iOS开发学习网站"><img src="./iOS 8自定义动画转场上手指南 - CocoaChina 苹果开发中文站 - 最热的iPhone开发社区 最热的苹果开发社区 最热的iPad开发社区_files/b4989d2761bc4f1ef24fd3744de85c43.jpg" style="max-height:60px" alt="11个超棒的iOS开发学习网站"></a><div style="margin-left:86px"><p class="related-intro"><a href="http://www.cocoachina.com/ios/20150626/11348.html" target="_blank" title="11个超棒的iOS开发学习网站">11个超棒的iOS开发学习网站</a></p><p class="hits">点击量<span>5503</span></p></div></li><li class="clearfix"><a href="http://www.cocoachina.com/ios/20150617/12148.html" class="float-l pic" target="_blank" title="2015 Objective-C 三大新特性"><img src="./iOS 8自定义动画转场上手指南 - CocoaChina 苹果开发中文站 - 最热的iPhone开发社区 最热的苹果开发社区 最热的iPad开发社区_files/e33c91eeaa9116364930b55173069146.jpg" style="max-height:60px" alt="2015 Objective-C 三大新特性"></a><div style="margin-left:86px"><p class="related-intro"><a href="http://www.cocoachina.com/ios/20150617/12148.html" target="_blank" title="2015 Objective-C 三大新特性">2015 Objective-C 三大新特性</a></p><p class="hits">点击量<span>5390</span></p></div></li><li class="clearfix"><a href="http://www.cocoachina.com/programmer/20150616/12132.html" class="float-l pic" target="_blank" title="一个平庸程序员的自白"><img src="./iOS 8自定义动画转场上手指南 - CocoaChina 苹果开发中文站 - 最热的iPhone开发社区 最热的苹果开发社区 最热的iPad开发社区_files/90acdfe6cd480951214d35f8d018376f.jpg" style="max-height:60px" alt="一个平庸程序员的自白"></a><div style="margin-left:86px"><p class="related-intro"><a href="http://www.cocoachina.com/programmer/20150616/12132.html" target="_blank" title="一个平庸程序员的自白">一个平庸程序员的自白</a></p><p class="hits">点击量<span>4905</span></p></div></li><li class="clearfix"><a href="http://www.cocoachina.com/ios/20150617/12151.html" class="float-l pic" target="_blank" title="iOS 9 新增 UIStackView 官方文档翻译"><img src="./iOS 8自定义动画转场上手指南 - CocoaChina 苹果开发中文站 - 最热的iPhone开发社区 最热的苹果开发社区 最热的iPad开发社区_files/b6fbc500da2b0c622c73ac428f963805.jpg" style="max-height:60px" alt="iOS 9 新增 UIStackView 官方文档翻译"></a><div style="margin-left:86px"><p class="related-intro"><a href="http://www.cocoachina.com/ios/20150617/12151.html" target="_blank" title="iOS 9 新增 UIStackView 官方文档翻译">iOS 9 新增 UIStackView 官方文档翻译</a></p><p class="hits">点击量<span>4816</span></p></div></li><li class="clearfix"><a href="http://www.cocoachina.com/ios/20150615/12125.html" class="float-l pic" target="_blank" title="iOS开发，事半功倍基本心得"><img src="./iOS 8自定义动画转场上手指南 - CocoaChina 苹果开发中文站 - 最热的iPhone开发社区 最热的苹果开发社区 最热的iPad开发社区_files/ac5a6bbdf4c5d90ca157234a03f0e31f.jpg" style="max-height:60px" alt="iOS开发，事半功倍基本心得"></a><div style="margin-left:86px"><p class="related-intro"><a href="http://www.cocoachina.com/ios/20150615/12125.html" target="_blank" title="iOS开发，事半功倍基本心得">iOS开发，事半功倍基本心得</a></p><p class="hits">点击量<span>4554</span></p></div></li><li class="clearfix"><a href="http://www.cocoachina.com/ios/20150616/12134.html" class="float-l pic" target="_blank" title="源码推荐(6.16)：高仿新浪微博，支付宝（高仿）源码"><img src="./iOS 8自定义动画转场上手指南 - CocoaChina 苹果开发中文站 - 最热的iPhone开发社区 最热的苹果开发社区 最热的iPad开发社区_files/2018b9b328a23e9d956a4583e175ed1b.jpg" style="max-height:60px" alt="源码推荐(6.16)：高仿新浪微博，支付宝（高仿）源码"></a><div style="margin-left:86px"><p class="related-intro"><a href="http://www.cocoachina.com/ios/20150616/12134.html" target="_blank" title="源码推荐(6.16)：高仿新浪微博，支付宝（高仿）源码">源码推荐(6.16)：高仿新浪微博，支付宝（高仿）源码</a></p><p class="hits">点击量<span>4291</span></p></div></li><li class="clearfix noborder-b"><a href="http://www.cocoachina.com/programmer/20150617/12170.html" class="float-l pic" target="_blank" title="怎么面试架构师"><img src="./iOS 8自定义动画转场上手指南 - CocoaChina 苹果开发中文站 - 最热的iPhone开发社区 最热的苹果开发社区 最热的iPad开发社区_files/3ef45adc3c96963f09304309f7a1caf3.jpg" style="max-height:60px" alt="怎么面试架构师"></a><div style="margin-left:86px"><p class="related-intro"><a href="http://www.cocoachina.com/programmer/20150617/12170.html" target="_blank" title="怎么面试架构师">怎么面试架构师</a></p><p class="hits">点击量<span>4087</span></p></div></li>	                             
                            </ul>
                        </div>
                   </div>
                   <!--./两周热门资讯推荐-->
                    <!-- 广告位：资讯频道列表页面右侧300*90-->
                    <div class="job-ad"><script>CNZZ_SLOT_RENDER('324555');</script></div>
                   <!--综合评论--> 
                    <div class="part-wrap clearfix" style="margin-top: 15px;">
                        <h3>综合评论</h3>
                        <ul class="related-comment clearfix">
							<li><span class="hide_comment">太美了</span><br><p><span>nimitz_007</span><span>评论了</span><a href="http://www.cocoachina.com/design/20150625/12261.html" title="UI界面并不是只有白色设计才叫极简设计" target="_blank"><span>UI界面并不是只有白色设计才叫极简设计</span></a></p></li><li><span class="hide_comment">https://itunes.apple.com/cn/app/si-mi-xin-xi-guan-jia/id790084948?mt=8</span><br><p><span>fengyi1103</span><span>评论了</span><a href="http://www.cocoachina.com/apple/20150629/12297.html" title="苹果改AppleCare+条款 保修期内免费换电池" target="_blank"><span>苹果改AppleCare+条款 保修期内免费换电池</span></a></p></li><li><span class="hide_comment">回复 <a target="_blank" href="http://www.cocoachina.com/bbs/u.php?uid=354184">darkjoker： </a>明显是某些活动中分享的ppt</span><br><p><span>alienjun</span><span>评论了</span><a href="http://www.cocoachina.com/programmer/20150629/12269.html" title="最全最强解析：支付宝钱包系统架构内部剖析（架构图）" target="_blank"><span>最全最强解析：支付宝钱包系统架构内部剖析（架构图）</span></a></p></li><li><span class="hide_comment">回复 <a target="_blank" href="http://www.cocoachina.com/bbs/u.php?uid=302734">lamcelot： </a>你什么眼神啊？</span><br><p><span>cli</span><span>评论了</span><a href="http://www.cocoachina.com/ios/20150626/11348.html" title="11个超棒的iOS开发学习网站" target="_blank"><span>11个超棒的iOS开发学习网站</span></a></p></li><li><span class="hide_comment">系统中常用的一系列容器类型都增加了泛型支持，甚至连 NSEnumerator 都支持了，这是非常 Nice 的改进。和 Nullability 一样，我认为最大的意义还是丰富了接口描述信息，对比下面两种写法：
@property (readonly) NSArray *imageURLs;
@property (readonly) NSArray *imageURLs;
不用多想就清楚下面的数组中存的是什么，避免了 NSString 和 NSURL 的混乱。

哪两种？</span><br><p><span>xx541100047</span><span>评论了</span><a href="http://www.cocoachina.com/ios/20150617/12148.html" title="2015 Objective-C 三大新特性" target="_blank"><span>2015 Objective-C 三大新特性</span></a></p></li><li><span class="hide_comment">这多语言是什么节奏。。。</span><br><p><span>带睡帽的青蛙</span><span>评论了</span><a href="http://www.cocoachina.com/programmer/20150626/12284.html" title="如何有效地报告 Bug" target="_blank"><span>如何有效地报告 Bug</span></a></p></li><li><span class="hide_comment">多少app做得不错,缺给通知毁了</span><br><p><span>OrlAnd0</span><span>评论了</span><a href="http://www.cocoachina.com/game/20150626/12281.html" title="有效发送游戏推送通知的6大诀窍" target="_blank"><span>有效发送游戏推送通知的6大诀窍</span></a></p></li><li><span class="hide_comment">storyboard......</span><br><p><span>OrlAnd0</span><span>评论了</span><a href="http://www.cocoachina.com/ios/20150623/12233.html" title="iOS 9: UIStackView入门" target="_blank"><span>iOS 9: UIStackView入门</span></a></p></li><li><span class="hide_comment">看了第一个我就笑了，为了达到按钮的效果，而关闭掉多点触碰，简（不）单（切）粗（实）暴（际）啊。
很多游戏都需要多点触摸的。
为何不在在menuitem上做文章呢？</span><br><p><span>小菜菜</span><span>评论了</span><a href="http://www.cocoachina.com/game/20150625/12268.html" title="【论坛推荐】姜老师的豆知识(游戏开发系列分享)" target="_blank"><span>【论坛推荐】姜老师的豆知识(游戏开发系列分享)</span></a></p></li><li class="noborder-b"><span class="hide_comment">苹果这个频率感觉不像是在更新操作系统啊，像是互联网产品一样
这么频繁</span><br><p><span>lizheng__114</span><span>评论了</span><a href="http://www.cocoachina.com/apple/20150624/12250.html" title="苹果三大系统齐更新：watchOS 2开放更多权限..." target="_blank"><span>苹果三大系统齐更新：watchOS 2开放更多权限...</span></a></p></li>						   
                        </ul>
                    </div>
                    <!--./综合评论-->
                    <!--相关帖子--> 
                    <div class="part-wrap clearfix" style="margin:15px 0 15px 0;">
                        <h3>相关帖子</h3>
                        <ul class="related-comment clearfix">
							<script charset="gb2312" src="./iOS 8自定义动画转场上手指南 - CocoaChina 苹果开发中文站 - 最热的iPhone开发社区 最热的苹果开发社区 最热的iPad开发社区_files/new.php"></script><li><a href="http://www.cocoachina.com/bbs/read.php?tid=308539" target="_blank">lua 3.6 arm64&nbsp;&nbsp;luajit 问题</a></li><li><a href="http://www.cocoachina.com/bbs/read.php?tid=308538" target="_blank">有没有大神会blockskit</a></li><li><a href="http://www.cocoachina.com/bbs/read.php?tid=308535" target="_blank">为什么cocos一直都没有骨骼动画编辑器呢</a></li><li><a href="http://www.cocoachina.com/bbs/read.php?tid=308534" target="_blank">BOX2D刚体删除问题。</a></li><li><a href="http://www.cocoachina.com/bbs/read.php?tid=308533" target="_blank">IOS 禁止部分页面横屏旋转</a></li><li><a href="http://www.cocoachina.com/bbs/read.php?tid=308532" target="_blank">lua 继承问题？！？！？</a></li><li><a href="http://www.cocoachina.com/bbs/read.php?tid=308531" target="_blank">求高斯模糊效果的例子</a></li><li><a href="http://www.cocoachina.com/bbs/read.php?tid=308530" target="_blank">请教一个关于schedule的问题</a></li><li class="clearfix noborder-b"><a href="http://www.cocoachina.com/bbs/read.php?tid=308529" target="_blank">cocosstudio 2.3.0.1 点击按钮缩小问题</a></li>						
                        </ul>
                    </div>
                    <!--./相关帖子-->  
					<iframe width="230" height="550" class="share_self" frameborder="0" scrolling="no" src="./iOS 8自定义动画转场上手指南 - CocoaChina 苹果开发中文站 - 最热的iPhone开发社区 最热的苹果开发社区 最热的iPad开发社区_files/saved_resource.html" style="display: none !important;"></iframe>
                </div>
            </div> 
            <!--./侧边栏-->           
		</div>
<div id="coco-store" style="display:none">
	<div class="storebox">
    	<h5>提示</h5>
        <h3>已经收藏该篇文章</h3>
        <p class="p1"><a href="http://www.cocoachina.com/bbs/u.php?action=favor&tag=1" target="_blank">去我的收藏夹</a></p>
        <p class="p2"><a href="http://www.cocoachina.com/bbs/login.php">请登录</a></p>
    </div>
</div> <!--收藏提示-->       

<script type="text/javascript">

function postDigg(ftype,aid)
{
	var taget_obj = document.getElementById('newdigg'); 
	var saveid = GetCookie('diggid');
	if(saveid != null)
	{
		var saveids = saveid.split(',');
		var hasid = false;
		saveid = '';
		j = 1;
		for(i=saveids.length-1;i>=0;i--)
		{
			if(saveids[i]==aid && hasid) continue;
			else {
				if(saveids[i]==aid && !hasid) hasid = true;
				saveid += (saveid=='' ? saveids[i] : ','+saveids[i]);
				j++;
				if(j==20 && hasid) break;
				if(j==19 && !hasid) break;
			}
		}
		if(hasid) { alert("您已经顶过该帖，请不要重复顶帖 ！"); return; }
		else saveid += ','+aid;
		SetCookie('diggid',saveid,1);
	}
	else
	{
		SetCookie('diggid',aid,1);
	}
	myajax = new DedeAjax(taget_obj,false,false,'','','');
	var url = "/cms/plus/digg_ajax.php?action="+ftype+"&id="+aid;
	myajax.SendGet2(url);
	DedeXHTTP = null;
	$('#zanbox').addClass('zanbox-selected');	
}
function getDigg(aid)
{
	var taget_obj = document.getElementById('newdigg');
	myajax = new DedeAjax(taget_obj,false,false,'','','');
	myajax.SendGet2("/cms/plus/digg_ajax.php?id="+aid);
	DedeXHTTP = null;
}


//显示对应的导航：
$(function(){
	var article_id = $('#article_id').val();
	var saveid = GetCookie('diggid');

	if(saveid != null)
	{
		var saveids = saveid.split(',');
		var hasid = false;
		saveid = '';
		j = 1;
		for(i=saveids.length-1;i>=0;i--)
		{
			if(saveids[i]==article_id && hasid) continue;
			else {
				if(saveids[i]==article_id && !hasid) hasid = true;
				saveid += (saveid=='' ? saveids[i] : ','+saveids[i]);
				j++;
				if(j==20 && hasid) break;
				if(j==19 && !hasid) break;
			}
		}
		
		if(hasid) 
		{ 
			$('#zanbox').addClass('zanbox-selected');			
		}

	}	


	// 根据作者名更新链接
	
	function updateAuthor(name) {
		if(name != "pockry" && name!= "suiling" && name!= "wupeng") {
			name = "suiling";
		}
		var urls = {
			"pockry": "http://www.cocoachina.com/bbs/u.php?action=feed&username=pockry",
			"suiling": "http://www.cocoachina.com/bbs/u.php?action=feed&uid=340873",
			"wupeng": "http://www.cocoachina.com/bbs/u.php?action=feed&uid=304691"
		};
		$("#field_author").attr("href", urls[name]).html(name);
	}
	updateAuthor("pockry");

});

window.onload = function() {
	
	$('#sharediv').removeClass('bdshare-button-style1-32');
	$('#sharediv').attr('class','bdsharebuttonbox');
}; 
</script>
<script type="text/javascript" src="./iOS 8自定义动画转场上手指南 - CocoaChina 苹果开发中文站 - 最热的iPhone开发社区 最热的苹果开发社区 最热的iPad开发社区_files/shCore.js"></script>
	<script type="text/javascript" src="./iOS 8自定义动画转场上手指南 - CocoaChina 苹果开发中文站 - 最热的iPhone开发社区 最热的苹果开发社区 最热的iPad开发社区_files/brush.js"></script>
	<link type="text/css" rel="stylesheet" href="./iOS 8自定义动画转场上手指南 - CocoaChina 苹果开发中文站 - 最热的iPhone开发社区 最热的苹果开发社区 最热的iPad开发社区_files/shCoreDefault.css">
	<script type="text/javascript">
	//SyntaxHighlighter.config.clipboardSwf = '/js/scripts/clipboard.swf';

	SyntaxHighlighter.all();</script>


<script>window._bd_share_config={"common":{"bdSnsKey":{},"bdText":"iOS 8自定义动画转场上手指南 - 来自CocoaChina苹果开发中文站@CocoaChina","bdMini":"2","bdMiniList":false,"bdPic":"http://api.cocoachina.com/uploads/150126/2b4f683650e27bdc46afd590bbafb4a2.jpg","bdStyle":"1","bdSize":"32"},"share":{}};with(document)0[(getElementsByTagName('head')[0]||body).appendChild(createElement('script')).src='http://bdimg.share.baidu.com/static/api//js/share.js?v=89860593.js?cdnversion='+~(-new Date()/36e5)];</script>
<!--./cont-->

</div>    
<!--右侧浮动-->
    <div class="r-bar" style="position: fixed; top: inherit; bottom: 10px;">
        <img src="./iOS 8自定义动画转场上手指南 - CocoaChina 苹果开发中文站 - 最热的iPhone开发社区 最热的苹果开发社区 最热的iPad开发社区_files/coco_weixin.png" class="weixin">
    	<a href="http://weibo.com/cocoachina" target="_blank" title="" class="weibo">sina</a>
        <a href="javascript:void(0);" target="_blank" title="" class="feedback">weixin</a>
        <a href="mailto:support@cocoachina.com" title="" class="kefu">mail</a>
        <a href="javascript:;" title="回到顶部" class="returntop" style="display: inline;">回到顶部</a>
    </div>

<script type="text/javascript">
$(function(){
	function search_check()
	{
		var search_keyword = $('#search_keyword').val();

		if( search_keyword.length < 2 )
		{
			alert("搜索关键字不能少于2个字节，请重新输入。");
		}
		else
		{
			$('#searchform').submit();
		}
	}


	var type = $('#type_name').html();
	if(type)
	{	
		switch( type )
		{
			case 'iOS开发':
				$('#ios').addClass('light');
				break;
			case 'AppStore研究':
				$('#app_store').addClass('light');
				break;
			case 'Mac开发':
				$('#mac').addClass('light');
				break;
			case '产品设计':
				$('#design').addClass('light');
				break;
			case 'Cocos引擎':
				$('#cocos').addClass('light');
				break;
			case 'WebApp':
				$('#webapp').addClass('light');
				break;
			case 'Swift':
				$('#swift').addClass('light');
				break;
			case '游戏开发':
				$('#game').addClass('light');
				break;
			case '苹果相关':
				$('#apple').addClass('light');
				break;
			case '营销推广':
				$('#market').addClass('light');
				break;		
			case '业界动态':
				$('#industry').addClass('light');
				break;	
			case '程序人生':
				$('#programmer').addClass('light');
				break;																																
				
		}
	}
});
</script>
<!--./cont-->
<script type="text/javascript" src="./iOS 8自定义动画转场上手指南 - CocoaChina 苹果开发中文站 - 最热的iPhone开发社区 最热的苹果开发社区 最热的iPad开发社区_files/index.js"></script>
<script src="./iOS 8自定义动画转场上手指南 - CocoaChina 苹果开发中文站 - 最热的iPhone开发社区 最热的苹果开发社区 最热的iPad开发社区_files/jquery.colorbox-min.js" type="text/javascript"></script>
<script language="javascript" src="./iOS 8自定义动画转场上手指南 - CocoaChina 苹果开发中文站 - 最热的iPhone开发社区 最热的苹果开发社区 最热的iPad开发社区_files/bbsauth_new2015.php" type="text/javascript"></script>
<script src="./iOS 8自定义动画转场上手指南 - CocoaChina 苹果开发中文站 - 最热的iPhone开发社区 最热的苹果开发社区 最热的iPad开发社区_files/script.js" type="text/javascript"></script>
<script type="text/javascript">
			jQuery(function()
			{
				//更改文章来源
				var source = $('#source a').html();								
				if( source == '未知' )
					jQuery('#source a').html('CocoaChina');
				if( jQuery('#source a').attr('href')=='')
					jQuery('#source').html('来源：'+source);
				
				//获取用户登录的id
				var content = jQuery('.t-lid').attr("href");
				var uid = 0;
				if( content )
				{
					content = content.split('=');
					uid = content[1];
				}
				var timestamp = new Date().getTime();	
				var uid2 = parseInt(uid);
				if(uid2==uid && uid2!=0){
					uid = uid<<2;			
					uid = uid+''+timestamp;
				}else{
					uid = "";
				}
				var oIframe=document.getElementById("comiframe");
				if(oIframe){
					var oUrl=window.location.href;
					oUrl = encodeURIComponent(oUrl);

					oIframe.src="http://www.cocoachina.com/comment.php?url="+oUrl+"&uid="+uid;
				}
				
			});
		</script>
<!--footer-->
<div class="footer clearfix">
    <div class="footer-b">
    	<div><a href="http://www.cocoachina.com/aboutus/index.html" target="_blank">关于我们</a><a href="http://www.cocoachina.com/contactus/index.html" target="_blank">广告合作</a><a target="_blank" href="mailto:support@cocoachina.com">联系我们</a></div>
    	<p>©2015 Chukong Technologies,Inc.
        <i> <a href="http://www.miibeian.gov.cn/" target="_blank">京ICP备 11006519号 　京ICP证 100954号</a> 京公网安备11010502020289 
			<a href="http://182.131.21.137/ccnt-apply/admin/business/preview/business-preview!lookUrlRFID.action?main_id=A580B24B1AE846CE9DA949026D63939F" target="_blank">
				<img src="./iOS 8自定义动画转场上手指南 - CocoaChina 苹果开发中文站 - 最热的iPhone开发社区 最热的苹果开发社区 最热的iPad开发社区_files/jingwen.png" style="margin: -10px auto -14px -10px;">
			京网文[2012]0426-138号</a>		
		</i>
		</p>
    </div>    
</div>
<!--./footer-->
<script language="javascript" type="text/javascript" src="./iOS 8自定义动画转场上手指南 - CocoaChina 苹果开发中文站 - 最热的iPhone开发社区 最热的苹果开发社区 最热的iPad开发社区_files/dedeajax2-min.js"></script>
<script type="text/javascript">

  var _gaq = _gaq || [];
  _gaq.push(['_setAccount', 'UA-16940817-2']);
  _gaq.push(['_trackPageview']);

  (function() {
    var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
    ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
    var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
  })();
  
 
function search_check()
{
	var search_keyword = $('#search_keyword').val();

	if( search_keyword.length < 2 )
	{
		alert("搜索关键字不能少于2个字节，请重新输入。");
	}
	else
	{
		$('#searchform').submit();
	}
}

</script>
<script>CNZZ_SLOT_RENDER('337970');</script>


<div id="cboxOverlay" style="display: none;"></div><div id="colorbox" class="" style="display: none;"><div id="cboxWrapper"><div><div id="cboxTopLeft" style="float: left;"></div><div id="cboxTopCenter" style="float: left;"></div><div id="cboxTopRight" style="float: left;"></div></div><div style="clear: left;"><div id="cboxMiddleLeft" style="float: left;"></div><div id="cboxContent" style="float: left;"><div id="cboxLoadedContent" style="width: 0px; height: 0px; overflow: hidden; float: left;"></div><div id="cboxLoadingOverlay" style="float: left;"></div><div id="cboxLoadingGraphic" style="float: left;"></div><div id="cboxTitle" style="float: left;"></div><div id="cboxCurrent" style="float: left;"></div><div id="cboxNext" style="float: left;"></div><div id="cboxPrevious" style="float: left;"></div><div id="cboxSlideshow" style="float: left;"></div><div id="cboxClose" style="float: left;"></div></div><div id="cboxMiddleRight" style="float: left;"></div></div><div style="clear: left;"><div id="cboxBottomLeft" style="float: left;"></div><div id="cboxBottomCenter" style="float: left;"></div><div id="cboxBottomRight" style="float: left;"></div></div></div><div style="position: absolute; width: 9999px; visibility: hidden; display: none;"></div></div><script type="text/javascript" async="" src="./iOS 8自定义动画转场上手指南 - CocoaChina 苹果开发中文站 - 最热的iPhone开发社区 最热的苹果开发社区 最热的iPad开发社区_files/cnzz.js"></script><script type="text/javascript">var vglnk = {api_url: '//api.viglink.com/api', key: '084c74521c465af0d8f08b63422103cc'};</script><script type="text/javascript" async="" src="./iOS 8自定义动画转场上手指南 - CocoaChina 苹果开发中文站 - 最热的iPhone开发社区 最热的苹果开发社区 最热的iPad开发社区_files/vglnk.js"></script><div id="__nightingale_view_cover" style="width: 100%; height: 100%; -webkit-transition: -webkit-transform 10s ease-in-out; transition: -webkit-transform 10s ease-in-out; position: fixed !important; left: 0px !important; bottom: 0px !important; overflow: hidden !important; pointer-events: none !important; z-index: 2147483647; opacity: 0; background: rgb(0, 0, 0) !important;"></div><div style="display:none"></div></body></html>