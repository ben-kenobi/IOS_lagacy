<!DOCTYPE HTML>
<html lang="en-US" >
    
    <head>
        
        <meta charset="UTF-8">
        <title>网络访问 | Swift 简介</title>
        <meta content="text/html; charset=utf-8" http-equiv="Content-Type">
        <meta name="description" content="">
        <meta name="generator" content="GitBook 1.0.3">
        <meta name="HandheldFriendly" content="true"/>
        <meta name="viewport" content="width=device-width, initial-scale=1, user-scalable=no">
        <meta name="apple-mobile-web-app-capable" content="yes">
        <meta name="apple-mobile-web-app-status-bar-style" content="black">
        <link rel="apple-touch-icon-precomposed" sizes="152x152" href="../gitbook/images/apple-touch-icon-precomposed-152.png">
        <link rel="shortcut icon" href="../gitbook/images/favicon.ico" type="image/x-icon">
        
    
    
    
    <link rel="next" href="../practice/README.html" />
    
    
    <link rel="prev" href="../oop/read only.html" />
    

        
    </head>
    <body>
        
        
<link rel="stylesheet" href="../gitbook/style.css">


        
    <div class="book"  data-level="0.5" data-basepath=".." data-revision="1448934061973">
    

<div class="book-summary">
    <div class="book-search">
        <input type="text" placeholder="Type to search" class="form-control" />
    </div>
    <ul class="summary">
        
    	
    	
    	

        

        
    
        
        <li class="chapter " data-level="0" data-path="index.html">
            
                
                    <a href="../index.html">
                        <i class="fa fa-check"></i>
                        
                         Swift 简介
                    </a>
                
            
            
            <ul class="articles">
                
    
        
        <li class="chapter " data-level="0.1" data-path="primer/README.html">
            
                
                    <a href="../primer/README.html">
                        <i class="fa fa-check"></i>
                        
                            <b>0.1.</b>
                        
                         快速体验
                    </a>
                
            
            
            <ul class="articles">
                
    
        
        <li class="chapter " data-level="0.1.1" data-path="primer/playground.html">
            
                
                    <a href="../primer/playground.html">
                        <i class="fa fa-check"></i>
                        
                            <b>0.1.1.</b>
                        
                         playground
                    </a>
                
            
            
        </li>
    
        
        <li class="chapter " data-level="0.1.2" data-path="primer/first app.html">
            
                
                    <a href="../primer/first app.html">
                        <i class="fa fa-check"></i>
                        
                            <b>0.1.2.</b>
                        
                         项目开发体验
                    </a>
                
            
            
        </li>
    

            </ul>
            
        </li>
    
        
        <li class="chapter " data-level="0.2" data-path="basic/README.html">
            
                
                    <a href="../basic/README.html">
                        <i class="fa fa-check"></i>
                        
                            <b>0.2.</b>
                        
                         基本语法
                    </a>
                
            
            
            <ul class="articles">
                
    
        
        <li class="chapter " data-level="0.2.1" data-path="basic/let and var.html">
            
                
                    <a href="../basic/let and var.html">
                        <i class="fa fa-check"></i>
                        
                            <b>0.2.1.</b>
                        
                         常量和变量
                    </a>
                
            
            
        </li>
    
        
        <li class="chapter " data-level="0.2.2" data-path="basic/optional.html">
            
                
                    <a href="../basic/optional.html">
                        <i class="fa fa-check"></i>
                        
                            <b>0.2.2.</b>
                        
                         Optional
                    </a>
                
            
            
        </li>
    
        
        <li class="chapter " data-level="0.2.3" data-path="basic/control flow.html">
            
                
                    <a href="../basic/control flow.html">
                        <i class="fa fa-check"></i>
                        
                            <b>0.2.3.</b>
                        
                         控制流
                    </a>
                
            
            
        </li>
    
        
        <li class="chapter " data-level="0.2.4" data-path="basic/loop.html">
            
                
                    <a href="../basic/loop.html">
                        <i class="fa fa-check"></i>
                        
                            <b>0.2.4.</b>
                        
                         循环
                    </a>
                
            
            
        </li>
    
        
        <li class="chapter " data-level="0.2.5" data-path="basic/string.html">
            
                
                    <a href="../basic/string.html">
                        <i class="fa fa-check"></i>
                        
                            <b>0.2.5.</b>
                        
                         字符串
                    </a>
                
            
            
        </li>
    
        
        <li class="chapter " data-level="0.2.6" data-path="basic/collection.html">
            
                
                    <a href="../basic/collection.html">
                        <i class="fa fa-check"></i>
                        
                            <b>0.2.6.</b>
                        
                         集合
                    </a>
                
            
            
        </li>
    

            </ul>
            
        </li>
    
        
        <li class="chapter " data-level="0.3" data-path="func/README.html">
            
                
                    <a href="../func/README.html">
                        <i class="fa fa-check"></i>
                        
                            <b>0.3.</b>
                        
                         函数
                    </a>
                
            
            
            <ul class="articles">
                
    
        
        <li class="chapter " data-level="0.3.1" data-path="func/func.html">
            
                
                    <a href="../func/func.html">
                        <i class="fa fa-check"></i>
                        
                            <b>0.3.1.</b>
                        
                         函数
                    </a>
                
            
            
        </li>
    
        
        <li class="chapter " data-level="0.3.2" data-path="func/closure.html">
            
                
                    <a href="../func/closure.html">
                        <i class="fa fa-check"></i>
                        
                            <b>0.3.2.</b>
                        
                         闭包
                    </a>
                
            
            
            <ul class="articles">
                
    
        
        <li class="chapter " data-level="0.3.2.1" data-path="func/closure define.html">
            
                
                    <a href="../func/closure define.html">
                        <i class="fa fa-check"></i>
                        
                            <b>0.3.2.1.</b>
                        
                         闭包的定义
                    </a>
                
            
            
        </li>
    
        
        <li class="chapter " data-level="0.3.2.2" data-path="func/closure basic.html">
            
                
                    <a href="../func/closure basic.html">
                        <i class="fa fa-check"></i>
                        
                            <b>0.3.2.2.</b>
                        
                         基本使用
                    </a>
                
            
            
        </li>
    
        
        <li class="chapter " data-level="0.3.2.3" data-path="func/closure retain cycle.html">
            
                
                    <a href="../func/closure retain cycle.html">
                        <i class="fa fa-check"></i>
                        
                            <b>0.3.2.3.</b>
                        
                         循环引用
                    </a>
                
            
            
        </li>
    

            </ul>
            
        </li>
    

            </ul>
            
        </li>
    
        
        <li class="chapter " data-level="0.4" data-path="oop/README.html">
            
                
                    <a href="../oop/README.html">
                        <i class="fa fa-check"></i>
                        
                            <b>0.4.</b>
                        
                         面向对象
                    </a>
                
            
            
            <ul class="articles">
                
    
        
        <li class="chapter " data-level="0.4.1" data-path="oop/init basic.html">
            
                
                    <a href="../oop/init basic.html">
                        <i class="fa fa-check"></i>
                        
                            <b>0.4.1.</b>
                        
                         构造函数基础
                    </a>
                
            
            
        </li>
    
        
        <li class="chapter " data-level="0.4.2" data-path="oop/overload init.html">
            
                
                    <a href="../oop/overload init.html">
                        <i class="fa fa-check"></i>
                        
                            <b>0.4.2.</b>
                        
                         重载构造函数
                    </a>
                
            
            
        </li>
    
        
        <li class="chapter " data-level="0.4.3" data-path="oop/init kvc.html">
            
                
                    <a href="../oop/init kvc.html">
                        <i class="fa fa-check"></i>
                        
                            <b>0.4.3.</b>
                        
                         KVC 构造函数
                    </a>
                
            
            
        </li>
    
        
        <li class="chapter " data-level="0.4.4" data-path="oop/init convenience.html">
            
                
                    <a href="../oop/init convenience.html">
                        <i class="fa fa-check"></i>
                        
                            <b>0.4.4.</b>
                        
                         便利构造函数
                    </a>
                
            
            
        </li>
    
        
        <li class="chapter " data-level="0.4.5" data-path="oop/lazy.html">
            
                
                    <a href="../oop/lazy.html">
                        <i class="fa fa-check"></i>
                        
                            <b>0.4.5.</b>
                        
                         懒加载
                    </a>
                
            
            
        </li>
    
        
        <li class="chapter " data-level="0.4.6" data-path="oop/read only.html">
            
                
                    <a href="../oop/read only.html">
                        <i class="fa fa-check"></i>
                        
                            <b>0.4.6.</b>
                        
                         只读属性
                    </a>
                
            
            
        </li>
    

            </ul>
            
        </li>
    
        
        <li class="chapter active" data-level="0.5" data-path="network/README.html">
            
                
                    <a href="../network/README.html">
                        <i class="fa fa-check"></i>
                        
                            <b>0.5.</b>
                        
                         网络访问
                    </a>
                
            
            
        </li>
    
        
        <li class="chapter " data-level="0.6" data-path="practice/README.html">
            
                
                    <a href="../practice/README.html">
                        <i class="fa fa-check"></i>
                        
                            <b>0.6.</b>
                        
                         项目演练
                    </a>
                
            
            
            <ul class="articles">
                
    
        
        <li class="chapter " data-level="0.6.1" data-path="practice/preparation.html">
            
                
                    <a href="../practice/preparation.html">
                        <i class="fa fa-check"></i>
                        
                            <b>0.6.1.</b>
                        
                         准备工作
                    </a>
                
            
            
        </li>
    
        
        <li class="chapter " data-level="0.6.2" data-path="practice/load data.html">
            
                
                    <a href="../practice/load data.html">
                        <i class="fa fa-check"></i>
                        
                            <b>0.6.2.</b>
                        
                         创建模型加载数据
                    </a>
                
            
            
        </li>
    
        
        <li class="chapter " data-level="0.6.3" data-path="practice/table view cell.html">
            
                
                    <a href="../practice/table view cell.html">
                        <i class="fa fa-check"></i>
                        
                            <b>0.6.3.</b>
                        
                         自定义 Cell
                    </a>
                
            
            
        </li>
    
        
        <li class="chapter " data-level="0.6.4" data-path="practice/detail view controller.html">
            
                
                    <a href="../practice/detail view controller.html">
                        <i class="fa fa-check"></i>
                        
                            <b>0.6.4.</b>
                        
                         明细控制器
                    </a>
                
            
            
        </li>
    

            </ul>
            
        </li>
    

            </ul>
            
        </li>
    


        
        <li class="divider"></li>
        <li>
            <a href="http://www.gitbook.io/" target="blank" class="gitbook-link">Published using GitBook</a>
        </li>
        
    </ul>
</div>

    <div class="book-body">
        <div class="body-inner">
            <div class="book-header">
    <!-- Actions Left -->
    <a href="#" class="btn pull-left toggle-summary" aria-label="Toggle summary"><i class="fa fa-align-justify"></i></a>
    <a href="#" class="btn pull-left toggle-search" aria-label="Toggle search"><i class="fa fa-search"></i></a>
    
    <div id="font-settings-wrapper" class="dropdown pull-left">
        <a href="#" class="btn toggle-dropdown" aria-label="Toggle font settings"><i class="fa fa-font"></i>
        </a>
        <div class="dropdown-menu font-settings">
    <div class="dropdown-caret">
        <span class="caret-outer"></span>
        <span class="caret-inner"></span>
    </div>

    <div class="buttons">
        <button type="button" id="reduce-font-size" class="button size-2">A</button>
        <button type="button" id="enlarge-font-size" class="button size-2">A</button>
    </div>

    <div class="buttons font-family-list">
        <button type="button" data-font="0" class="button">Serif</button>
        <button type="button" data-font="1" class="button">Sans</button>
    </div>

    <div class="buttons color-theme-list">
        <button type="button" id="color-theme-preview-0" class="button size-3" data-theme="0">White</button>
        <button type="button" id="color-theme-preview-1" class="button size-3" data-theme="1">Sepia</button>
        <button type="button" id="color-theme-preview-2" class="button size-3" data-theme="2">Night</button>
    </div>
</div>

    </div>

    <!-- Actions Right -->
    
    <div class="dropdown pull-right">
        <a href="#" class="btn toggle-dropdown" aria-label="Toggle share dropdown"><i class="fa fa-share-alt"></i>
        </a>
        <div class="dropdown-menu font-settings dropdown-left">
            <div class="dropdown-caret">
                <span class="caret-outer"></span>
                <span class="caret-inner"></span>
            </div>
            <div class="buttons">
                <button type="button" data-sharing="twitter" class="button">Twitter</button>
                <button type="button" data-sharing="google-plus" class="button">Google</button>
                <button type="button" data-sharing="facebook" class="button">Facebook</button>
                <button type="button" data-sharing="weibo" class="button">Weibo</button>
                <button type="button" data-sharing="instapaper" class="button">Instapaper</button>
            </div>
        </div>
    </div>
    

    
    <a href="#" target="_blank" class="btn pull-right google-plus-sharing-link sharing-link" data-sharing="google-plus" aria-label="Share on Google Plus"><i class="fa fa-google-plus"></i></a>
    
    
    <a href="#" target="_blank" class="btn pull-right facebook-sharing-link sharing-link" data-sharing="facebook" aria-label="Share on Facebook"><i class="fa fa-facebook"></i></a>
    
    
    <a href="#" target="_blank" class="btn pull-right twitter-sharing-link sharing-link" data-sharing="twitter" aria-label="Share on Twitter"><i class="fa fa-twitter"></i></a>
    
    

    <!-- Title -->
    <h1>
        <i class="fa fa-circle-o-notch fa-spin"></i>
        <a href="../" >Swift 简介</a>
    </h1>
</div>

            <div class="page-wrapper" tabindex="-1">
                <div class="page-inner">
                
                
                    <section class="normal" id="section-gitbook_23">
                    
                        <h1 id="xcode-7-">Xcode 7 中的网络请求</h1>
<h1 id="ats-">ATS 应用传输安全</h1>
<p>App Transport Security (ATS) lets an app add a declaration to its Info.plist file that specifies the domains with which it needs secure communication. ATS prevents accidental disclosure, provides secure default behavior, and is easy to adopt. You should adopt ATS as soon as possible, regardless of whether you’re creating a new app or updating an existing one. <br /><br />If you’re developing a new app, you should use HTTPS exclusively. If you have an existing app, you should use HTTPS as much as you can right now, and create a plan for migrating the rest of your app as soon as possible.</p>
<h2 id="">强制访问</h2>
<pre><code class="lang-plist"><span class="hljs-tag">&lt;<span class="hljs-title">key</span>&gt;</span>NSAppTransportSecurity<span class="hljs-tag">&lt;/<span class="hljs-title">key</span>&gt;</span>
<span class="hljs-tag">&lt;<span class="hljs-title">dict</span>&gt;</span>
  <span class="hljs-comment">&lt;!--Include to allow all connections (DANGER)--&gt;</span>
  <span class="hljs-tag">&lt;<span class="hljs-title">key</span>&gt;</span>NSAllowsArbitraryLoads<span class="hljs-tag">&lt;/<span class="hljs-title">key</span>&gt;</span>
      <span class="hljs-tag">&lt;<span class="hljs-title">true</span>/&gt;</span>
<span class="hljs-tag">&lt;/<span class="hljs-title">dict</span>&gt;</span>
</code></pre>
<h2 id="">设置白名单</h2>
<pre><code class="lang-plist"><span class="hljs-tag">&lt;<span class="hljs-title">key</span>&gt;</span>NSAppTransportSecurity<span class="hljs-tag">&lt;/<span class="hljs-title">key</span>&gt;</span>
<span class="hljs-tag">&lt;<span class="hljs-title">dict</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-title">key</span>&gt;</span>NSExceptionDomains<span class="hljs-tag">&lt;/<span class="hljs-title">key</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-title">dict</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-title">key</span>&gt;</span>localhost<span class="hljs-tag">&lt;/<span class="hljs-title">key</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-title">dict</span>&gt;</span>
            <span class="hljs-tag">&lt;<span class="hljs-title">key</span>&gt;</span>NSTemporaryExceptionAllowsInsecureHTTPLoads<span class="hljs-tag">&lt;/<span class="hljs-title">key</span>&gt;</span>
            <span class="hljs-tag">&lt;<span class="hljs-title">true</span>/&gt;</span>
        <span class="hljs-tag">&lt;/<span class="hljs-title">dict</span>&gt;</span>
    <span class="hljs-tag">&lt;/<span class="hljs-title">dict</span>&gt;</span>
<span class="hljs-tag">&lt;/<span class="hljs-title">dict</span>&gt;</span>
</code></pre>
<ul>
<li>网络访问代码</li>
</ul>
<pre><code class="lang-swift"><span class="hljs-keyword">let</span> url = <span class="hljs-type">NSURL</span>(string: <span class="hljs-string">"http://www.weather.com.cn/data/sk/101010100.html"</span>)!

<span class="hljs-type">NSURLSession</span>.sharedSession().dataTaskWithURL(url) { (data, <span class="hljs-number">_</span>, error) <span class="hljs-keyword">in</span>
    <span class="hljs-keyword">if</span> error != <span class="hljs-built_in">nil</span> {
        <span class="hljs-built_in">print</span>(error)
        <span class="hljs-keyword">return</span>
    }

}.resume()
</code></pre>
<ul>
<li><p>运行提示：App Transport Security has blocked a cleartext HTTP (http://) resource load since it is insecure. Temporary exceptions can be configured via your app&#39;s Info.plist file.</p>
</li>
<li><p>JSON 序列化</p>
</li>
</ul>
<pre><code class="lang-swift"><span class="hljs-keyword">let</span> dict = try! <span class="hljs-type">NSJSONSerialization</span>.<span class="hljs-type">JSONObjectWithData</span>(data!, options: <span class="hljs-type">NSJSONReadingOptions</span>(rawValue: <span class="hljs-number">0</span>))
<span class="hljs-built_in">print</span>(dict)
</code></pre>
<ul>
<li>try catch</li>
</ul>
<pre><code class="lang-swift"><span class="hljs-keyword">do</span> {
    <span class="hljs-keyword">let</span> tmpData = <span class="hljs-string">"{\"name\": \"zhangsan\"}"</span>.dataUsingEncoding(<span class="hljs-type">NSUTF8StringEncoding</span>)
    <span class="hljs-keyword">let</span> dict = try <span class="hljs-type">NSJSONSerialization</span>.<span class="hljs-type">JSONObjectWithData</span>(tmpData!, options: <span class="hljs-type">NSJSONReadingOptions</span>[])
    <span class="hljs-built_in">print</span>(dict)
} catch {
    <span class="hljs-built_in">print</span>(error)
}
</code></pre>

                    
                    </section>
                
                
                </div>
            </div>
        </div>

        
        <a href="../oop/read only.html" class="navigation navigation-prev " aria-label="Previous page: 只读属性"><i class="fa fa-angle-left"></i></a>
        
        
        <a href="../practice/README.html" class="navigation navigation-next " aria-label="Next page: 项目演练"><i class="fa fa-angle-right"></i></a>
        
    </div>
</div>

        
<script src="../gitbook/app.js"></script>

    
    <script src="https://cdn.mathjax.org/mathjax/2.4-latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
    

    
    <script src="../gitbook/plugins/gitbook-plugin-mathjax/plugin.js"></script>
    

<script>
require(["gitbook"], function(gitbook) {
    var config = {"fontSettings":{"theme":null,"family":"sans","size":2}};
    gitbook.start(config);
});
</script>

        
    </body>
    
</html>
